{"paragraphs":[{"text":"%pyspark\n\n# Zeppelin notebook to enrich domain summaries (from Paul 5) with examples (from Paul 6)\n# and topic metadata (from Tom 1)\n# PJ - 9 November 2017\n\nimport boto\nfrom pyspark.sql.types import *\n\n# Load Domain Summaries DF in Gzip files (from Paul 5)\nloadURL=\"s3://billsdata.net/CommonCrawl/domain_summaries6/\" # Split into 20 files (as opposed to domain_summaries7, which is 10)\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nsummary_df=spark.read.format('com.databricks.spark.csv').options(header='true', codec=codec).load(loadURL)\nsummary_df.show(3)\nsummary_df.cache()\nsummary_df.rdd.getNumPartitions()","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------+-------------+----------+-----------+--------------+------+------+\n|payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|\n+--------------+--------+-------------+----------+-----------+--------------+------+------+\n|         37.ac|       1|         true|         1|       null|         false|49.503|47.723|\n|      equal.ac|       1|         true|         3|          3|          true|69.571|68.098|\n|      happy.ac|       1|         true|         2|          6|          true|19.030|69.999|\n+--------------+--------+-------------+----------+-----------+--------------+------+------+\nonly showing top 3 rows\n\n20\n"}]},"apps":[],"jobName":"paragraph_1510241350259_-22898601","id":"20171023-080924_1586412256","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:29:57+0000","dateFinished":"2017-11-09T15:29:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:196"},{"text":"%pyspark\n\n# Load examples dataframe (from Paul 6)\nexamplesURI=\"s3://billsdata.net/CommonCrawl/domain_examples4/\"\nexample_df=spark.read.load(examplesURI)\nexample_df.show(10)\nexample_df.cache()\nexample_df.rdd.getNumPartitions()","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|                 PLD|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------------------+--------------------+--------------------+\n|0----------------...|[0---------------...|         [nomina.ru]|                null|\n|           0-0la.com|         [0-0la.com]|[jessicawilson.co...|[wordpress.org, g...|\n|           0-3-6.com|         [0-3-6.com]|[3d114.com, menok...|                null|\n|           0-3ani.ro|         [0-3ani.ro]|[cere.ro, adedir....|                null|\n|           0-5-1.com|         [0-5-1.com]|    [allthecom.info]|                null|\n|       0-60times.net|     [0-60times.net]|[lodekka.com, kev...|                null|\n|            0-744.cn|          [0-744.cn]|     [wordpress.com]|                null|\n|0-ads-free-web-pa...|[0-ads-free-web-p...|[list-of-domains....|                null|\n|       0-artlove.net|     [0-artlove.net]|[list-of-domains....|                null|\n|  0-clubpenguin-0.tk|[0-clubpenguin-0.tk]|  [similarsites.com]|                null|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n256\n"}]},"apps":[],"jobName":"paragraph_1510241350260_-24822346","id":"20171103-135448_580425054","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:29:57+0000","dateFinished":"2017-11-09T15:29:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:197"},{"text":"%pyspark\n\n# Remove square brackets from list output and remove Nulls\nfrom pyspark.sql.functions import udf\ndef remove_brackets(egs):\n    return str(egs).replace('[', '').replace(']', '')\nprint(remove_brackets(\"[bla, bla]\"))\nudf_remove_brackets = udf(remove_brackets, StringType())\n\nexample_df2=example_df.filter(example_df.PLD.isNotNull()).withColumn(\"tmp\", udf_remove_brackets(\"exampleOutLinkPlds\")).drop(\"exampleOutLinkPlds\").withColumnRenamed(\"tmp\",\"exampleOutLinkPlds\")\nexample_df3=example_df2.withColumn(\"tmp\", udf_remove_brackets(\"exampleInLinkPlds\")).drop(\"exampleInLinkPlds\").withColumnRenamed(\"tmp\",\"exampleInLinkPlds\")\nexample_df4=example_df3.withColumn(\"tmp\", udf_remove_brackets(\"exampleHosts\")).drop(\"exampleHosts\").withColumnRenamed(\"tmp\",\"exampleHosts\").select(\"PLD\",\"exampleHosts\",\"exampleInLinkPlds\",\"exampleOutLinkPlds\")\nexample_df4.show(10)\nexample_df4.count()\n","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bla, bla\n+--------------------+--------------------+--------------------+--------------------+\n|                 PLD|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------------------+--------------------+--------------------+\n|0----------------...|0----------------...|           nomina.ru|                None|\n|           0-0la.com|           0-0la.com|jessicawilson.co....|wordpress.org, gm...|\n|           0-3-6.com|           0-3-6.com|3d114.com, menok....|                None|\n|           0-3ani.ro|           0-3ani.ro|cere.ro, adedir.info|                None|\n|           0-5-1.com|           0-5-1.com|      allthecom.info|                None|\n|       0-60times.net|       0-60times.net|lodekka.com, kevi...|                None|\n|            0-744.cn|            0-744.cn|       wordpress.com|                None|\n|0-ads-free-web-pa...|0-ads-free-web-pa...| list-of-domains.org|                None|\n|       0-artlove.net|       0-artlove.net| list-of-domains.org|                None|\n|  0-clubpenguin-0.tk|  0-clubpenguin-0.tk|    similarsites.com|                None|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n90839924\n"}]},"apps":[],"jobName":"paragraph_1510241350260_-24822346","id":"20171103-141703_260872707","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:29:58+0000","dateFinished":"2017-11-09T15:30:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:198"},{"text":"%pyspark\n\n# Join with Original summaries\nexample_df.unpersist()\nexample_summary_df=summary_df.join(example_df4, summary_df.payLevelDomain==example_df4.PLD).drop(\"PLD\")\nsummary_df.unpersist()\nexample_summary_df.dropDuplicates().sort(\"numHosts\",ascending=False).show(100)\nexample_summary_df.count()","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|        hotsited.com|   99995|         true|        29|          8|          true|66.638|61.568|hotsited.com, arc...|rdlj.ir, digicamh...|google.com, googl...|\n|  unknownsecret.info|    9997|         true|        20|       null|         false|88.451|80.312|unknownsecret.inf...|list-of-domains.o...|                None|\n|         b2csoez.com|     999|         true|        12|          7|          true|95.657|74.462|b2csoez.com, 007s...|blogspot.com, blo...|yahoo.com, f701.c...|\n|            557b.com|     999|         true|       108|         70|          true|93.512|96.842|557b.com, 110001....|5ccs.com, ek59.co...|557h.com, 9ttu.co...|\n|          dtyyt1.com|     999|         true|        12|          3|          true|89.673|67.896|dtyyt1.com, a.dty...|blogspot.com, blo...|ticrf.org.tw, eet...|\n|          cbm665.com|     999|         true|        50|         19|          true|89.652|80.355|cbm665.com, a.cbm...|tyuqw59.com, bb19...|avmm088.com, hkk5...|\n|           me225.com|     999|         true|        97|        268|          true|88.579|94.149|me225.com, a1.me2...|e26a.com, lineav....|yahoo.com, bb1.id...|\n|           ywkqg.com|     999|         true|         2|         13|          true|17.173|63.071|ywkqg.com, 1136p....|8r7.info, ywxinya...|youdao.com, iqiyi...|\n|         kefhk86.com|     999|         true|        17|        464|          true|89.651|76.575|kefhk86.com, a.ke...|kokyu58.com, blog...|hwe5.com, ks573.c...|\n|            557r.com|     999|         true|       102|         56|          true|87.182|96.569|557r.com, x.557r....|5ccs.com, ek59.co...|u676.com, 291ld.c...|\n|            557h.com|     999|         true|       112|         61|          true|87.183|97.027|557h.com, x.557h....|blogspot.com, x03...|4x2b.com, x076.co...|\n|              eur.vg|     999|        false|         3|       null|         false|97.258|64.636|a-flatwebdirector...|blogspot.com, blo...|                None|\n|         jhjhkk9.com|     999|         true|        10|         18|          true|86.460|68.907|jhjhkk9.com, a.jh...|ddft1.com, kkyytt...|yahoo.com, yy1235...|\n|          hkfr55.com|     999|         true|        16|        268|          true|89.651|79.461|hkfr55.com, a.hkf...|blogspot.com, klk...|cilis.net, kk69mm...|\n|          dtyyt2.com|     999|         true|        15|          3|          true|89.673|80.812|dtyyt2.com, a.dty...|ddft1.com, kkyytt...|ticrf.org.tw, kky...|\n|            dzvdb.cn|     999|        false|       204|         84|          true|17.015|73.251|0axwj.dzvdb.cn, 0...|00ba6.net, 00ya0....|01iv0.net, 00mw7....|\n|            c26b.com|     999|         true|        96|         35|          true|87.852|94.119|c26b.com, a1.c26b...|e26a.com, lineav....|cuiyu.info, macro...|\n|         12sweet.com|     999|         true|         1|          4|          true|66.851|39.676|12sweet.com, a.12...|             yam.com|yahoo.com, ssapp1...|\n|          eaek24.com|     999|         true|        37|          5|          true|89.668|88.850|eaek24.com, a.eae...|blogspot.com, tyu...|ticrf.org.tw, aa7...|\n|           hhry2.com|     999|         true|        11|         19|          true|88.209|69.252|hhry2.com, a.hhry...|blogspot.ca, ddft...|yahoo.com, ishow9...|\n|           hhry1.com|     999|         true|        12|          3|          true|86.460|75.488|hhry1.com, a.hhry...|ddft1.com, kkyytt...|ygnm4.com, ticrf....|\n|          jhfr67.com|     999|         true|        13|        455|          true|87.085|76.843|jhfr67.com, a.jhf...|kuku67.com, kkk26...|fwwd5.com, 38cc.c...|\n|           01jf5.net|     999|         true|       278|        831|          true|22.132|78.303|01jf5.net, 0aigk....|00do4.net, 00dr6....|lusst.cn, 00dy2.n...|\n|englishvillage.or...|     999|         true|        11|       null|         false|90.801|54.685|englishvillage.or...|blogspot.com, blo...|                None|\n|          ppol65.com|     999|         true|        43|         14|          true|89.619|80.265|ppol65.com, a.ppo...|tyuqw59.com, bb19...|rcyykk.com, show9...|\n|         tyhop38.com|     999|         true|        52|          2|          true|89.660|80.949|tyhop38.com, a.ty...|kokyu58.com, avni...|yahoo.com, ticrf....|\n|           vipmp.com|     999|         true|       230|        254|          true|74.557|97.632|vipmp.com, 05shil...|fcxn.net, borog.c...|borog.com, yuding...|\n|          eaek22.com|     999|         true|        37|          2|          true|89.668|89.051|eaek22.com, a.eae...|blogspot.com, yww...|yahoo.com, ticrf....|\n|        woxingma.com|     999|         true|       202|        230|          true|69.039|96.955|woxingma.com, 0xc...|butlercarcare.com...|yudingall.cn, wuz...|\n|          eaek23.com|     999|         true|        37|          5|          true|89.668|89.039|eaek23.com, a.eae...|blogspot.com, yww...|kmm3267.com, kkm3...|\n|         jhjhkk7.com|     999|         true|         8|         17|          true|86.458|66.301|jhjhkk7.com, a.jh...|ddft1.com, ddft2....|kkyt257.com, ticr...|\n|   taiwan-gis.org.tw|     999|         true|        11|       null|         false|90.801|54.685|taiwan-gis.org.tw...|blogspot.com, blo...|                None|\n|          jhfr66.com|     999|         true|        12|         44|          true|86.223|76.750|jhfr66.com, a.jhf...|blogspot.com, klk...|yk272.com, kuku67...|\n|          eaek25.com|     999|         true|        38|         15|          true|89.668|89.387|eaek25.com, a.eae...|blogspot.com, yww...|ticrf.org.tw, aa7...|\n|           kgfs1.com|     999|         true|        11|         18|          true|86.460|68.908|kgfs1.com, a.kgfs...|ddft1.com, kkyytt...|yahoo.com, ishow9...|\n|            557j.com|     999|         true|       109|         79|          true|87.182|96.774|557j.com, x.557j....|blogspot.com, x03...|5eei.com, 557h.co...|\n|           fhfu8.com|     999|         true|         4|       null|         false|26.426|59.483|fhfu8.com, a.fhfu...|ddft1.com, ddft2....|                None|\n|            557n.com|     999|         true|       106|         79|          true|87.182|96.671|557n.com, x.557n....|k327.com, 341b.co...|5eei.com, 557h.co...|\n|        uthome51.com|     999|         true|       109|          9|          true|89.603|91.288|uthome51.com, a1....|bb198.net, hwe7.c...|gogo176.com, macr...|\n|         jhjhkk8.com|     999|         true|         9|         19|          true|86.460|71.042|jhjhkk8.com, a.jh...|blogspot.com, kky...|yahoo.com, yy1235...|\n|           fhfu9.com|     999|         true|         5|         56|          true|85.730|61.397|fhfu9.com, a.fhfu...|ddft2.com, ddft4....|hwe5.com, zkt5.co...|\n|         kefhk87.com|     999|         true|        28|        309|          true|89.651|84.005|kefhk87.com, a.ke...|blogspot.hk, yyy5...|fwwd5.com, 38cc.c...|\n|       tangcang57.cn|     999|        false|        91|       null|         false|49.346|78.175|0611rx.tangcang57...|zzejgvd.net, pack...|                None|\n|            557i.com|     999|         true|       109|         64|          true|87.182|96.837|557i.com, x.557i....|5ccs.com, ek59.co...|8bss.com, ex57.co...|\n|       darani9pi.net|     999|         true|        13|       null|         false|77.126|81.983|darani9pi.net, 02...|airbbs.net, fc2.c...|                None|\n|           kgfs2.com|     999|         true|        12|         18|          true|89.943|69.972|kgfs2.com, a.kgfs...|blogspot.com, kte...|yahoo.com, ishow9...|\n|    seriousdeals.net|     999|         true|        82|          4|          true|99.363|98.953|seriousdeals.net,...|mundu.org, websit...|jzrputtbut.net, z...|\n|          eaek21.com|     999|         true|        41|          5|          true|89.705|91.374|eaek21.com, a.eae...|tyuqw59.com, upot...|ticrf.org.tw, aa7...|\n|         jhjhkk6.com|     999|         true|         9|          4|          true|86.460|70.916|jhjhkk6.com, a.jh...|blogspot.com, ddf...|yahoo.com, aatk5....|\n|           azbuz.com|     999|         true|       460|       null|         false|99.827|98.870|azbuz.com, 06ct.a...|blogspot.com, sec...|                None|\n|          jhfe34.com|     999|         true|        20|        455|          true|89.651|80.950|jhfe34.com, a.jhf...|kuku67.com, hffek...|fwwd5.com, 38cc.c...|\n|         diysoez.com|     999|         true|         8|         16|          true|95.429|63.991|diysoez.com, 007s...|blogspot.com, aiv...|yahoo.com, f701.c...|\n|            c26a.com|     999|         true|        96|         32|          true|87.852|94.119|c26a.com, a1.c26a...|goav173.info, v75...|ncc33.com, girl57...|\n|            557p.com|     999|         true|       106|         73|          true|87.182|96.667|557p.com, x.557p....|5ccs.com, ek59.co...|ek59.com, 4x2b.co...|\n|         sweag11.com|     999|         true|        51|         12|          true|89.660|81.319|sweag11.com, a.sw...|tyuqw59.com, bb19...|kk1008.com, rcyyk...|\n|         jhjhkk5.com|     999|         true|         9|         18|          true|89.847|66.794|jhjhkk5.com, a.jh...|ddft1.com, kkyytt...|yahoo.com, yy1235...|\n|           bigtc.com|     999|         true|       207|         59|          true|58.686|97.281|bigtc.com, 0xc000...|jxxgqt.com, licha...|fcxn.net, directd...|\n|          hkfr54.com|     999|         true|        15|         38|          true|89.651|77.550|hkfr54.com, a.hkf...|blogspot.com, klk...|yk272.com, kuku67...|\n|          sxdd32.com|     999|         true|        46|          2|          true|89.652|80.020|sxdd32.com, a.sxd...|a8aaa.com, blogsp...|ticrf.org.tw, yah...|\n|          blogia.com|    9989|         true|      5857|      69618|          true|99.991|99.962|blogia.com, 03am....|martinmaglio.com....|artear.com.ar, el...|\n|      visualgrep.com|  998136|         true|         6|         16|          true|46.114|88.601|visualgrep.com, 0...|visualdiffer.com,...|iciba.com, makepo...|\n|          acsjzs.com|    9980|         true|        28|        131|          true|47.381|64.399|acsjzs.com, 002.a...|rileblog.com, kin...|62670.xyz, gougou...|\n|     huafangfund.com|     998|         true|       210|        253|          true|45.647|96.995|huafangfund.com, ...|applemy.com, dyla...|borog.com, yuding...|\n|       yuzhiqing.net|     998|         true|       195|        239|          true|45.044|96.447|yuzhiqing.net, 13...|dylanlauren.net, ...|borog.com, yuding...|\n|           yymm5.com|     998|         true|        11|         50|          true|89.673|69.654|yymm5.com, a.yymm...|ddft1.com, blogsp...|kkkyt1266.com, ut...|\n|            6ccs.com|     998|         true|       114|         66|          true|87.231|97.609|6ccs.com, l1.6ccs...|k327.com, 341b.co...|yahoo.com, 520liv...|\n|        miyanali.com|     998|         true|       230|         57|          true|98.284|96.794|miyanali.com, 091...|rdlj.ir, wegetari...|uploadfa.net, yar...|\n|            nnt2.com|     998|         true|        17|       null|         false|75.594|72.095|nnt2.com, abenats...|ninja-web.net, li...|                None|\n|         advsoez.com|     998|         true|        12|          7|          true|96.061|66.333|advsoez.com, 007s...|blogspot.com, blo...|m085.com, e154.in...|\n|      lichanggen.net|     998|         true|       200|        256|          true|45.044|96.855|lichanggen.net, 1...|fcxn.net, borog.c...|borog.com, yuding...|\n|       multiforum.nl|     998|         true|       329|       null|         false|97.397|99.583|multiforum.nl, 30...|vindhetviahier.nl...|                None|\n|      superqiche.com|     998|         true|       203|        242|          true|46.742|96.849|superqiche.com, 1...|butlercarcare.com...|borog.com, yuding...|\n|         kuparts.com|     998|         true|       159|        137|          true|75.191|99.534|kuparts.com, act....|jxedt.com, sina.c...|jxedt.com, shushi...|\n| kaiguandianyuan.org|     998|         true|        11|         13|          true|17.194|81.238|kaiguandianyuan.o...|chinawjd.com, gun...|cnlinfo.net, soku...|\n|              deb.gs|     998|         true|        67|       null|         false|99.444|95.593|deb.gs, 001e5205....|newgrounds.com, h...|                None|\n|              cld.bz|     998|         true|      2918|         27|          true|99.954|99.990|cld.bz, 7thdaybap...|blogspot.com, coc...|arvo.org, cjca.ne...|\n|           yymm4.com|     998|         true|         3|       null|         false|26.426|55.600|yymm4.com, a.yymm...|ddft1.com, ddft4....|                None|\n|      wenwenzhuan.cn|     998|        false|         2|         13|          true|17.009|37.658|11qyl.wenwenzhuan...|pinpaibang.cc, 8r...|youdao.com, iqiyi...|\n|            asmen.cn|     998|         true|       488|        391|          true|64.744|99.587|asmen.cn, ab.asme...|40volts.com, daim...|hodxb.com, skojia...|\n|   uni-goettingen.de|     998|         true|      8488|       6143|          true|99.996|99.994|uni-goettingen.de...|kurt-bauer-geschi...|att.com, cell-sym...|\n|           fzint.net|     998|         true|       238|        304|          true|94.139|97.807|fzint.net, 0713dy...|blogspot.com, jxx...|xmzxyj.cn, borog....|\n|         sex-zone.pl|     998|         true|        41|          3|          true|93.957|89.142|sex-zone.pl, amat...|theglobe.net, wyk...|dotpay.pl, dyskre...|\n|           neon24.pl|     998|         true|       238|       2088|          true|99.769|98.949|neon24.pl, 101kot...|blogspot.com, zie...|utexas.edu, anima...|\n|        tpacc.org.tw|     998|         true|        18|       null|         false|90.930|58.475|tpacc.org.tw, 100...|dorfonlaw.org, bl...|                None|\n|            557m.com|     998|         true|       107|         77|          true|87.182|96.736|557m.com, x.557m....|k327.com, 341b.co...|8bss.com, ex57.co...|\n|            1id3.com|     998|         true|        13|       null|         false|67.364|85.120|1id3.com, x1.1id3...|av57.com, yam.com...|                None|\n|     smfforfree3.com|     998|         true|       179|        773|          true|99.862|99.056|smfforfree3.com, ...|4umer.com, barene...|flickr.com, panti...|\n|          hebkjxx.cn|    9972|         true|        68|         37|          true|64.102|96.529|hebkjxx.cn, 002vm...|xinwenge.org, prp...|zretc.com, admin5...|\n|       hydonghua.com|    9971|         true|        41|        131|          true|47.498|81.127|hydonghua.com, 00...|vidikupi.com, ton...|qv03.site, 60336....|\n|              dal.ca|     997|         true|      6820|       7080|          true|99.996|99.989|dal.ca, ac.dal.ca...|cas.ca, ecojustic...|unimelb.edu.au, b...|\n|             sbw6.cc|     997|        false|        10|       null|         false|31.968|39.355|01bh.sbw6.cc, 022...|grlfrnd.com, hiba...|                None|\n|         fenzhi.info|     997|         true|       203|        231|          true|46.495|96.777|fenzhi.info, 0278...|butlercarcare.com...|qijiaqi.net, tang...|\n|raviolimakerstore...|     997|         true|         4|        133|          true|77.082|56.264|raviolimakerstore...|typepad.com, over...|ganzhiqi.cn, 300z...|\n|            8bss.com|     997|         true|       109|         49|          true|86.432|97.055|8bss.com, 110001....|k327.com, 341b.co...|x077.com, 4s2u.co...|\n| annuairefrancais.fr|     997|         true|       111|         99|          true|99.786|98.641|annuairefrancais....|blogspot.com, kin...|socotam.com, blue...|\n|            2b1d.com|     997|         true|        22|         58|          true|86.289|87.778|2b1d.com, x1.2b1d...|blogspot.com, 2c8...|av104.tv, 8bss.co...|\n|      dapinguo123.cn|     997|        false|         2|         13|          true|17.009|32.929|11g9s.dapinguo123...|8r7.info, dounanf...|youdao.com, iqiyi...|\n|              dal.ca|     997|         true|      3456|       2047|          true|99.996|99.989|dal.ca, ac.dal.ca...|cas.ca, ecojustic...|unimelb.edu.au, b...|\n|         minimals.ru|     997|         true|        12|          6|          true|91.293|99.170|minimals.ru, 0par...|blogspot.com, liv...|googleapis.com, o...|\n|            dbdh.xyz|     997|         true|         1|       null|         false|17.835|25.301|dbdh.xyz, adidas....|          mixpot.biz|                None|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\nonly showing top 100 rows\n\n91034040\n"}]},"apps":[],"jobName":"paragraph_1510241350260_-24822346","id":"20171103-135636_1283074493","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:29:59+0000","dateFinished":"2017-11-09T15:32:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:199"},{"text":"%pyspark\n\n# Save Example Summaries as GZIP files, approx 100MB each.\n#outURI=\"s3://billsdata.net/CommonCrawl/domain_summaries_withexamples4/\"\n#codec=\"org.apache.hadoop.io.compress.GzipCodec\"\n#example_summary_df.coalesce(40).write.format('com.databricks.spark.csv').options(header='true', codec=codec).save(outURI) # Creates 94x23.8MB files by default\nprint(\"SAVE HERE FOR ONLY EXAMPLE SUMMARIES\")","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SAVE HERE FOR ONLY EXAMPLE SUMMARIES\n"}]},"apps":[],"jobName":"paragraph_1510241350261_-25207095","id":"20171103-140215_1756777634","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:30:33+0000","dateFinished":"2017-11-09T15:32:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:200"},{"text":"%pyspark\n\n# Load topic labels (from Tom 1)\nloadURL=\"s3://billsdata.net/CommonCrawl/topic_model_2048_files/cc_index_page_topic_labels/\" # TODO - switch to 2048!\ntopic_df=spark.read.load(loadURL)\ntopic_df.show(3)\nprint(topic_df.count())\ntopic_df.cache()\ntopic_df.rdd.getNumPartitions()","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|                host|                 url|              topic1|             score1|              topic2|              score2|              topic3|              score3|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\n|  astro.uchicago.edu|http://astro.uchi...|news_article_new_...|0.31914721112987016|said_like_one_lov...| 0.27035210388505515|university_resear...| 0.14147791332687423|\n|blog.greenmountai...|http://blog.green...|said_like_one_lov...| 0.2992614679052542|hotels_hotel_reso...| 0.21444496753319794|views_january_day...| 0.17792143718874276|\n|        cleotube.com|http://cleotube.c...|porn_sex_tube_vid...| 0.9935485634990251|islands_republic_...|0.003696503953861141|page_wiki_add_com...|2.863101549746408...|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 3 rows\n\n105744\n147\n"}]},"apps":[],"jobName":"paragraph_1510241350261_-25207095","id":"20171023-081217_1250969967","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:32:16+0000","dateFinished":"2017-11-09T15:32:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:201"},{"text":"%pyspark\n\n# From Paul 5.\n\n# Load in an uncompressed, partitioned format, for fast reading in the future\nsaveURI=\"s3://billsdata.net/CommonCrawl/hyperlinkgraph/cc-main-2017-may-jun-jul/domaingraph/vertices/\"\n#pld_df.coalesce(64).write.save(saveURI) # Use all default options\npld_df=spark.read.load(saveURI)\npld_df.show(3)\npld_df.cache()\n#print(pld_df.count()) # Should have 91M domains","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+\n| ID|    PLD|\n+---+-------+\n|  0|  aaa.a|\n|  1| aaa.aa|\n|  2|aaa.aaa|\n+---+-------+\nonly showing top 3 rows\n\nDataFrame[ID: string, PLD: string]\n"}]},"apps":[],"jobName":"paragraph_1510241350261_-25207095","id":"20171108-100011_1754193907","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:32:17+0000","dateFinished":"2017-11-09T15:32:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"text":"%pyspark\n\n# From Paul 5.\n\n# Next, we'll construct a local dictionary from of all the PLDS (key is the PLD, value is the ID)\n# This is our truth-table of known PLDs that we'll use when counting hosts\n# Create a bloom filter using a pure python package (might be a little slow)\nfrom pybloom import BloomFilter\npld_bf = BloomFilter(capacity=91000000, error_rate=0.005)\n\nfor row in pld_df.rdd.collect(): # limit(10000000) # TODO: Still bad (and exceeds spark.driver.maxResultSize with all rows)!\n    pld_bf.add(row['PLD'])\n\nprint(pld_df.rdd.take(3))\nprint(pld_df.rdd.take(3)[2]['PLD'])\n#pld_bf.add(pld_df.rdd.take(3)[2]['PLD'])\nprint(\"aaa.aaa\" in pld_bf) # Should be True\n\nimport sys\nprint(sys.getsizeof(pld_bf))\nprint(len(pld_bf)) # Should match number of items entered\n\n# Broadcast the bloom filter so it's available on all the slave nodes - we don't need to change\n# it any more so it's fine being immutable.\npld_bf_distrib=sc.broadcast(pld_bf)\n\nprint(\"aaa.aaa\" in pld_bf) # Should be true\nprint(\"aaa.aaa.bla\" in pld_bf) # Should be false\nprint(\"aaa.aaa\" in pld_bf_distrib.value) # Should be true\nprint(\"aaa.aaa.bla\" in pld_bf_distrib.value) # Should be false","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510241350261_-25207095","id":"20171108-095927_1270326887","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:32:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(ID=u'0', PLD=u'aaa.a'), Row(ID=u'1', PLD=u'aaa.aa'), Row(ID=u'2', PLD=u'aaa.aaa')]\naaa.aaa\nTrue\n64\n90751305\nTrue\nFalse\nTrue\nFalse\n"}]},"dateFinished":"2017-11-09T15:58:50+0000"},{"text":"%pyspark\n\n# From Paul 5.\n\n# Returns a Boolean to say whether PLD is a hostname in itself\ndef is_a_pld(hostname):\n    #if hostname in pld_lookup_table:\n    #if pld_lookup_table.filter(lambda a: a == hostname).count()>0:\n    if hostname in pld_bf_distrib.value:\n        return True\n    else:\n        return False\n        \n# Define a function to do the hostname->pld conversion, if the pld exists in our dictionary \ndef convert_hostname(hostname):\n    # Return hostname as-is, if this is already a PLD\n    #if hostname in pld_lookup_table:\n    #if pld_lookup_table.filter(lambda a: a == hostname).count()>0:\n    if hostname in pld_bf_distrib.value:\n        return hostname\n    # Otherwise we're going to have to split it up and test the parts\n    try:\n        parts=hostname.split('.')\n        if (len(parts)>4 and is_a_pld('.'.join(parts[0:4]))):\n            return '.'.join(parts[0:4])\n        if (len(parts)>3 and is_a_pld('.'.join(parts[0:3]))):\n            return '.'.join(parts[0:3])\n        if (len(parts)>2 and is_a_pld('.'.join(parts[0:2]))):\n            return '.'.join(parts[0:2])\n        if (len(parts)>1 and is_a_pld('.'.join(parts[0:1]))):\n            return '.'.join(parts[0:1])\n        return \"ERROR\" # Couldn't find a corresponding PLD - this should never happen!\n    except:\n        return \"ERROR\"\n\nudf_convert_hostname = udf(convert_hostname, StringType())\n\n# Test\nprint(convert_hostname(\"aaa.aaa\"))\nprint(is_a_pld(\"aaa.aaa\")) # Should be true","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510241350261_-25207095","id":"20171108-095830_940370411","dateCreated":"2017-11-09T15:29:10+0000","dateStarted":"2017-11-09T15:32:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:204","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"aaa.aaa\nTrue\n"}]},"dateFinished":"2017-11-09T15:58:50+0000"},{"text":"%pyspark\n\n# Function to reverse hostnames\nfrom pyspark.sql.functions import udf\ndef reverse_domain(domain):\n    return '.'.join(reversed(domain.split('.')))\nprint(reverse_domain(\"com.facebook\"))\nudf_reverse_domain = udf(reverse_domain, StringType())\n\n# Convert hosts in Topic DF to PLDs using convert_hostname function from Paul 5.\ntopic_df2=topic_df.withColumn(\"pld\",udf_reverse_domain(udf_convert_hostname(udf_reverse_domain(\"host\")))) # Reverse the hostnames prior to lookup, then back again!\ntopic_df2.show(10)","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"facebook.com\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|                host|                 url|              topic1|             score1|              topic2|              score2|              topic3|              score3|                 pld|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|  astro.uchicago.edu|http://astro.uchi...|news_article_new_...|0.31914721112987016|said_like_one_lov...| 0.27035210388505515|university_resear...| 0.14147791332687423|        uchicago.edu|\n|blog.greenmountai...|http://blog.green...|said_like_one_lov...| 0.2992614679052542|hotels_hotel_reso...| 0.21444496753319794|views_january_day...| 0.17792143718874276|greenmountaininn.com|\n|        cleotube.com|http://cleotube.c...|porn_sex_tube_vid...| 0.9935485634990251|islands_republic_...|0.003696503953861141|page_wiki_add_com...|2.863101549746408...|        cleotube.com|\n|  crisscrossjazz.com|http://crisscross...|david_john_michae...| 0.3745201570805343|music_class_uil_b...| 0.28559376243146695|ski_women_bike_ja...| 0.16079463023155172|  crisscrossjazz.com|\n|   dblp.uni-trier.de|http://dblp.uni-t...|ski_women_bike_ja...| 0.2810432980452748|university_resear...|  0.2564484525770813|download_free_sea...| 0.15294606790996684|        uni-trier.de|\n|dir.genealogytoda...|http://dir.geneal...|download_free_sea...|0.35826980253301133|library_news_home...| 0.33021610077329966|new_united_north_...| 0.26781414804211356|  genealogytoday.com|\n|     docs.oracle.com|http://docs.oracl...|com_game_games_se...| 0.7657313008960019|org_java_share_an...| 0.21715791120514005|page_wiki_add_com...|1.778261831262432...|          oracle.com|\n|     docs.oracle.com|http://docs.oracl...|files_linux_photo...| 0.5740341728919156|software_business...|  0.1565987096659622|org_java_share_an...| 0.15612336311052114|          oracle.com|\n|     dreamtwinks.com|http://dreamtwink...|porn_sex_tube_vid...| 0.8122328657014137|com_game_games_se...|  0.1725291215175307|page_wiki_add_com...|1.583749919950373...|     dreamtwinks.com|\n|     dreamtwinks.com|http://dreamtwink...|porn_sex_tube_vid...| 0.6891152208939914|com_game_games_se...|  0.2924838747220019|page_wiki_add_com...|1.912482373122567...|     dreamtwinks.com|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510241350262_-24052848","id":"20171023-081653_2145141554","dateCreated":"2017-11-09T15:29:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:205","dateFinished":"2017-11-09T15:58:52+0000","dateStarted":"2017-11-09T15:58:50+0000"},{"text":"%pyspark\n\n# If multiple rows per PLD, only use the one with the shortest URL.\ndef url_len(url):\n    return len(url)\nprint(url_len(\"com.facebook.bla\"))\nudf_url_len = udf(url_len, IntegerType())\nfrom pyspark.sql.functions import col, desc\ntopic_df3=topic_df2.withColumn(\"url_len\", udf_url_len(\"url\"))\n#topic_df3.show(30)\n\n# Use window functions to filter to only the row with the shortest URL for each PLD\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import rank, col\nwindow = Window.partitionBy(topic_df3['pld']).orderBy(topic_df3['url_len']) # Ascending order of URL length\ntopic_df4=topic_df3.select('*', rank().over(window).alias('rank')).filter(col('rank') <= 1)\ntopic_df4.show(20)\n\n# TODO: Consider putting the three topic columns into a single column.","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"16\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+------------------+-------+----+\n|                host|                 url|              topic1|             score1|              topic2|              score2|              topic3|              score3|               pld|url_len|rank|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+------------------+-------+----+\n|         700tube.com|http://700tube.co...|porn_sex_tube_vid...| 0.9718434204283675|view_south_east_a...|0.013170055792799444|inc_llc_products_...| 0.00917061289059415|       700tube.com|     50|   1|\n|www.aboutscotland...|http://www.abouts...|sale_property_are...| 0.4262481589985052|said_like_one_lov...|  0.1929938567392897|reviews_hotel_roo...| 0.17040038774305444| aboutscotland.com|     46|   1|\n|   www.actionbyte.de|http://www.action...|page_wiki_add_com...| 0.5062772833320252|said_like_one_lov...|0.005078184004531452|news_new_sports_g...|0.005072838552032...|     actionbyte.de|     40|   1|\n| www.azamgarh.nic.in|http://www.azamga...|information_servi...| 0.5353592438344755|university_illino...|  0.2610267844247096|download_free_sea...| 0.09160727485368315|   azamgarh.nic.in|     49|   1|\n|         behairy.com|http://behairy.co...|porn_sex_tube_vid...| 0.8230222567285717|download_free_sea...| 0.11698270863495107|david_john_michae...| 0.05828369702255593|       behairy.com|     64|   1|\n|         behairy.com|http://behairy.co...|porn_sex_tube_vid...| 0.8275399935960447|download_free_sea...| 0.12240800286393659|david_john_michae...|0.048322264288788136|       behairy.com|     64|   1|\n|         behairy.com|http://behairy.co...|porn_sex_tube_vid...| 0.8090929154655998|download_free_sea...| 0.11713093878822073|david_john_michae...| 0.07208578792832225|       behairy.com|     64|   1|\n|         behairy.com|http://behairy.co...|porn_sex_tube_vid...| 0.8250114733632464|download_free_sea...|  0.1264106404199821|david_john_michae...| 0.04685124133770203|       behairy.com|     64|   1|\n|         behairy.com|http://behairy.co...|porn_sex_tube_vid...| 0.8249370983378203|download_free_sea...|  0.1180124766479175|david_john_michae...| 0.05537182630503831|       behairy.com|     64|   1|\n|www.chester-jense...|http://www.cheste...|david_john_michae...| 0.2645494348182479|inc_llc_products_...|  0.2603211953958203|document_geteleme...| 0.23348354412455652|chester-jensen.com|     40|   1|\n|         www.cmu.edu|http://www.cmu.ed...|university_resear...| 0.7930618164877749|new_john_lhblk_st...| 0.10985124039316259|views_january_day...| 0.05310735450633527|           cmu.edu|     33|   1|\n|         www.cmu.edu|http://www.cmu.ed...|university_resear...| 0.7919300397654346|cell_protein_sex_...| 0.15335284335516533|david_john_michae...|  0.0262016766978846|           cmu.edu|     33|   1|\n|   www.com2media.com|http://www.com2me...|information_servi...|0.38418043058257784|com_game_games_se...| 0.19748302138113874|use_site_informat...| 0.19251118010797869|     com2media.com|     41|   1|\n|    www.cuballot.com|https://www.cubal...|information_servi...|   0.78118276597855|university_illino...| 0.09346353271716815|offer_store_valid...| 0.06860783251648371|      cuballot.com|     35|   1|\n|   www.developer.com|http://www.develo...|software_business...|0.43964334819024137|org_java_share_an...|  0.2643188175353565|score_com_link_en...| 0.09116916228506447|     developer.com|     92|   1|\n|       www.dorsum.ch|http://www.dorsum...|paint_blue_false_...|0.35867070032863335|would_one_reply_s...|  0.1975368198943007|parts_products_eq...| 0.09020212007024025|         dorsum.ch|     43|   1|\n|  www.fixmestick.com|https://www.fixme...|software_business...| 0.3041808604551504|score_com_link_en...| 0.25411776084762194|email_sign_passwo...| 0.19716608814299735|    fixmestick.com|     37|   1|\n|          www.gm.com|http://www.gm.com...|car_used_cars_for...|0.24807215199829574|estate_home_real_...| 0.24367577994697237|information_servi...| 0.23547711850312247|            gm.com|     28|   1|\n|          www.gov.ie|http://www.gov.ie...|com_game_games_se...|0.48361005289212355|download_free_sea...| 0.23879516280888485|information_servi...| 0.10695324129979228|            gov.ie|     55|   1|\n| www.hayonorolog.com|http://www.hayono...|park_collection_c...|0.19711897425945504|gift_cards_new_mu...|  0.1931611300819156|accessories_price...|  0.1570703288129018|   hayonorolog.com|     42|   1|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+------------------+-------+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1510241350262_-24052848","id":"20171109-100957_801598180","dateCreated":"2017-11-09T15:29:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:206","dateFinished":"2017-11-09T15:59:01+0000","dateStarted":"2017-11-09T15:58:50+0000"},{"text":"%pyspark\n\n# Join on host/PLD\npld_df.unpersist()\ntopic_df2.unpersist()\ntopic_df3.unpersist()\nenrich_summary_df=example_summary_df.join(topic_df4, example_summary_df.payLevelDomain==topic_df.host, \"leftOuter\")\\\n                                    .drop(\"host\").drop(\"url\").drop(\"score1\").drop(\"score2\").drop(\"score3\").drop(\"url_len\").drop(\"rank\").drop(\"topic2\").drop(\"topic3\").drop(\"pld\")\\\n                                    .withColumnRenamed(\"topic1\",\"exampleIndexPageTopics\").dropDuplicates()\nenrich_summary_df.sort(\"numHosts\",ascending=False).show()\nenrich_summary_df.count()","user":"anonymous","dateUpdated":"2017-11-09T16:28:16+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+----------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|exampleIndexPageTopics|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+----------------------+\n|        hotsited.com|   99995|         true|        29|          8|          true|66.638|61.568|hotsited.com, arc...|rdlj.ir, digicamh...|google.com, googl...|                  null|\n|  unknownsecret.info|    9997|         true|        20|       null|         false|88.451|80.312|unknownsecret.inf...|list-of-domains.o...|                None|                  null|\n|           01jf5.net|     999|         true|       278|        831|          true|22.132|78.303|01jf5.net, 0aigk....|00do4.net, 00dr6....|lusst.cn, 00dy2.n...|                  null|\n|            557p.com|     999|         true|       106|         73|          true|87.182|96.667|557p.com, x.557p....|5ccs.com, ek59.co...|ek59.com, 4x2b.co...|                  null|\n|         kefhk87.com|     999|         true|        28|        309|          true|89.651|84.005|kefhk87.com, a.ke...|blogspot.hk, yyy5...|fwwd5.com, 38cc.c...|                  null|\n|            557h.com|     999|         true|       112|         61|          true|87.183|97.027|557h.com, x.557h....|blogspot.com, x03...|4x2b.com, x076.co...|                  null|\n|           hhry2.com|     999|         true|        11|         19|          true|88.209|69.252|hhry2.com, a.hhry...|blogspot.ca, ddft...|yahoo.com, ishow9...|                  null|\n|         diysoez.com|     999|         true|         8|         16|          true|95.429|63.991|diysoez.com, 007s...|blogspot.com, aiv...|yahoo.com, f701.c...|                  null|\n|            c26a.com|     999|         true|        96|         32|          true|87.852|94.119|c26a.com, a1.c26a...|goav173.info, v75...|ncc33.com, girl57...|                  null|\n|          jhfr66.com|     999|         true|        12|         44|          true|86.223|76.750|jhfr66.com, a.jhf...|blogspot.com, klk...|yk272.com, kuku67...|                  null|\n|          eaek25.com|     999|         true|        38|         15|          true|89.668|89.387|eaek25.com, a.eae...|blogspot.com, yww...|ticrf.org.tw, aa7...|                  null|\n|           azbuz.com|     999|         true|       460|       null|         false|99.827|98.870|azbuz.com, 06ct.a...|blogspot.com, sec...|                None|                  null|\n|           bigtc.com|     999|         true|       207|         59|          true|58.686|97.281|bigtc.com, 0xc000...|jxxgqt.com, licha...|fcxn.net, directd...|                  null|\n|       darani9pi.net|     999|         true|        13|       null|         false|77.126|81.983|darani9pi.net, 02...|airbbs.net, fc2.c...|                None|                  null|\n|          eaek21.com|     999|         true|        41|          5|          true|89.705|91.374|eaek21.com, a.eae...|tyuqw59.com, upot...|ticrf.org.tw, aa7...|                  null|\n|            557j.com|     999|         true|       109|         79|          true|87.182|96.774|557j.com, x.557j....|blogspot.com, x03...|5eei.com, 557h.co...|                  null|\n|         12sweet.com|     999|         true|         1|          4|          true|66.851|39.676|12sweet.com, a.12...|             yam.com|yahoo.com, ssapp1...|                  null|\n|           kgfs1.com|     999|         true|        11|         18|          true|86.460|68.908|kgfs1.com, a.kgfs...|ddft1.com, kkyytt...|yahoo.com, ishow9...|                  null|\n|         jhjhkk6.com|     999|         true|         9|          4|          true|86.460|70.916|jhjhkk6.com, a.jh...|blogspot.com, ddf...|yahoo.com, aatk5....|                  null|\n|englishvillage.or...|     999|         true|        11|       null|         false|90.801|54.685|englishvillage.or...|blogspot.com, blo...|                None|                  null|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+----------------------+\nonly showing top 20 rows\n\n91026522\n"}]},"apps":[],"jobName":"paragraph_1510241350262_-24052848","id":"20171108-114205_1373138614","dateCreated":"2017-11-09T15:29:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:207","dateFinished":"2017-11-09T16:30:32+0000","dateStarted":"2017-11-09T16:28:16+0000"},{"text":"%pyspark\n\n# Save Example Summaries as GZIP files, approx 100MB each.\noutURI=\"s3://billsdata.net/CommonCrawl/domain_summaries_withtopics3/\"\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nenrich_summary_df.coalesce(40).write.format('com.databricks.spark.csv').options(header='true', codec=codec).save(outURI) # coalesce(40) creates 94x23.8MB files by default","user":"anonymous","dateUpdated":"2017-11-09T16:30:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1510241350263_-24437597","id":"20171023-082228_1219608625","dateCreated":"2017-11-09T15:29:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208","dateFinished":"2017-11-09T16:32:29+0000","dateStarted":"2017-11-09T16:30:43+0000"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-11-09T15:29:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1510241350263_-24437597","id":"20171109-105109_2094006765","dateCreated":"2017-11-09T15:29:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:209"}],"name":"Paul 7 - enrich domain summary","id":"2CWYPF3UG","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}