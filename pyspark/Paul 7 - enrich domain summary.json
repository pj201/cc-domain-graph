{"paragraphs":[{"text":"%pyspark\n\n# Zeppelin notebook to enrich domain summaries (from Paul 5) with examples (from Paul 6)\n# and topic metadata (from Tom 1)\n# PJ - 3 November 2017\n\nimport boto\nfrom pyspark.sql.types import *\n\n# Load Domain Summaries DF in Gzip files (from Paul 5)\nloadURL=\"s3://billsdata.net/CommonCrawl/domain_summaries6/\" # Split into 20 files (as opposed to domain_summaries7, which is 10)\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nsummary_df=spark.read.format('com.databricks.spark.csv').options(header='true', codec=codec).load(loadURL)\nsummary_df.show(3)\nsummary_df.cache()\nsummary_df.rdd.getNumPartitions()","dateUpdated":"2017-11-03T14:57:38+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------+-------------+----------+-----------+--------------+------+------+\n|payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|\n+--------------+--------+-------------+----------+-----------+--------------+------+------+\n|         37.ac|       1|         true|         1|       null|         false|49.503|47.723|\n|      equal.ac|       1|         true|         3|          3|          true|69.571|68.098|\n|      happy.ac|       1|         true|         2|          6|          true|19.030|69.999|\n+--------------+--------+-------------+----------+-----------+--------------+------+------+\nonly showing top 3 rows\n\n20\n"}]},"apps":[],"jobName":"paragraph_1509721046349_-657992096","id":"20171023-080924_1586412256","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:269","user":"anonymous","dateFinished":"2017-11-03T14:58:19+0000","dateStarted":"2017-11-03T14:57:38+0000"},{"text":"%pyspark\n\n# Load examples dataframe (from Paul 6)\nexamplesURI=\"s3://billsdata.net/CommonCrawl/domain_examples4/\"\nexample_df=spark.read.load(examplesURI)\nexample_df.show(10)\nexample_df.cache()\nexample_df.rdd.getNumPartitions()","dateUpdated":"2017-11-03T14:58:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+------------+-----------------+--------------------+\n| PLD|exampleHosts|exampleInLinkPlds|  exampleOutLinkPlds|\n+----+------------+-----------------+--------------------+\n|null|        null|             null|     [instagram.com]|\n|null|        null|             null|       [godaddy.com]|\n|null|        null|             null|       [4.cn, 51.la]|\n|null|        null|             null|[food.it, compro....|\n|null|        null|             null|[web2printsoftwar...|\n|null|        null|             null|[nu.nl, rtl.nl, g...|\n|null|        null|             null|       [apdesign.be]|\n|null|        null|             null|           [ovh.net]|\n|null|        null|             null|[zonneschermenams...|\n|null|        null|             null|    [googleapis.com]|\n+----+------------+-----------------+--------------------+\nonly showing top 10 rows\n\n204\n"}]},"apps":[],"jobName":"paragraph_1509721046352_-646834378","id":"20171103-135448_580425054","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270","user":"anonymous","dateFinished":"2017-11-03T14:58:36+0000","dateStarted":"2017-11-03T14:58:32+0000"},{"text":"%pyspark\n\n# Remove square brackets from list output and remove Nulls\nfrom pyspark.sql.functions import udf\ndef remove_brackets(egs):\n    return str(egs).replace('[', '').replace(']', '')\nprint(remove_brackets(\"[bla, bla]\"))\nudf_remove_brackets = udf(remove_brackets, StringType())\n\nexample_df2=example_df.filter(example_df.PLD.isNotNull()).withColumn(\"tmp\", udf_remove_brackets(\"exampleOutLinkPlds\")).drop(\"exampleOutLinkPlds\").withColumnRenamed(\"tmp\",\"exampleOutLinkPlds\")\nexample_df3=example_df2.withColumn(\"tmp\", udf_remove_brackets(\"exampleInLinkPlds\")).drop(\"exampleInLinkPlds\").withColumnRenamed(\"tmp\",\"exampleInLinkPlds\")\nexample_df4=example_df3.withColumn(\"tmp\", udf_remove_brackets(\"exampleHosts\")).drop(\"exampleHosts\").withColumnRenamed(\"tmp\",\"exampleHosts\").select(\"PLD\",\"exampleHosts\",\"exampleInLinkPlds\",\"exampleOutLinkPlds\")\nexample_df4.show(10)\nexample_df4.count()\n","dateUpdated":"2017-11-03T14:58:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bla, bla\n+-------------------+--------------------+--------------------+------------------+\n|                PLD|        exampleHosts|   exampleInLinkPlds|exampleOutLinkPlds|\n+-------------------+--------------------+--------------------+------------------+\n|            0-0a.me|         dev.0-0a.me|     krijnhoetmer.nl|              None|\n|    0-3-suikast.org|     0-3-suikast.org| list-of-domains.org|              None|\n|         0-5-0.info|          0-5-0.info| list-of-domains.org|              None|\n|            0-6.biz|             0-6.biz|     beyondwhois.com|              None|\n|      0-6health.com|       0-6health.com|      allthecom.info|              None|\n|            0-a.net|             0-a.net|      allthecom.info|              None|\n|  0-apr-lifetime.cn|establish-credit-...|             fc2.com|              None|\n|0-aprcreditcards.us| 0-aprcreditcards.us| list-of-domains.org|              None|\n|     0-artlove.info|      0-artlove.info| list-of-domains.org|              None|\n|         0-blog.com|     web2.0-blog.com|blogspot.com, seo...|              None|\n+-------------------+--------------------+--------------------+------------------+\nonly showing top 10 rows\n\n90839924\n"}]},"apps":[],"jobName":"paragraph_1509721046352_-646834378","id":"20171103-141703_260872707","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:271","user":"anonymous","dateFinished":"2017-11-03T14:59:23+0000","dateStarted":"2017-11-03T14:58:44+0000"},{"text":"%pyspark\n\n# Join with Original summaries\nexample_df.unpersist()\nexample_summary_df=summary_df.join(example_df4, summary_df.payLevelDomain==example_df4.PLD).drop(\"PLD\")\nsummary_df.unpersist()\nexample_summary_df.dropDuplicates().sort(\"numHosts\",ascending=False).show(100)\nexample_summary_df.count()","dateUpdated":"2017-11-03T15:00:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|        hotsited.com|   99995|         true|        29|          8|          true|66.638|61.568|hotsited.com, arc...|rdlj.ir, digicamh...|google.com, googl...|\n|  unknownsecret.info|    9997|         true|        20|       null|         false|88.451|80.312|unknownsecret.inf...|list-of-domains.o...|                None|\n|         jhjhkk8.com|     999|         true|         9|         19|          true|86.460|71.042|jhjhkk8.com, a.jh...|blogspot.com, kky...|yahoo.com, yy1235...|\n|         b2csoez.com|     999|         true|        12|          7|          true|95.657|74.462|b2csoez.com, 007s...|blogspot.com, blo...|yahoo.com, f701.c...|\n|         sweag11.com|     999|         true|        51|         12|          true|89.660|81.319|sweag11.com, a.sw...|tyuqw59.com, bb19...|kk1008.com, rcyyk...|\n|          eaek24.com|     999|         true|        37|          5|          true|89.668|88.850|eaek24.com, a.eae...|blogspot.com, tyu...|ticrf.org.tw, aa7...|\n|         tyhop38.com|     999|         true|        52|          2|          true|89.660|80.949|tyhop38.com, a.ty...|kokyu58.com, avni...|yahoo.com, ticrf....|\n|         jhjhkk9.com|     999|         true|        10|         18|          true|86.460|68.907|jhjhkk9.com, a.jh...|ddft1.com, kkyytt...|yahoo.com, yy1235...|\n|           fhfu8.com|     999|         true|         4|       null|         false|26.426|59.483|fhfu8.com, a.fhfu...|ddft1.com, ddft2....|                None|\n|            557r.com|     999|         true|       102|         56|          true|87.182|96.569|557r.com, x.557r....|5ccs.com, ek59.co...|u676.com, 291ld.c...|\n|            c26b.com|     999|         true|        96|         35|          true|87.852|94.119|c26b.com, a1.c26b...|e26a.com, lineav....|cuiyu.info, macro...|\n|          ppol65.com|     999|         true|        43|         14|          true|89.619|80.265|ppol65.com, a.ppo...|tyuqw59.com, bb19...|rcyykk.com, show9...|\n|            557n.com|     999|         true|       106|         79|          true|87.182|96.671|557n.com, x.557n....|k327.com, 341b.co...|5eei.com, 557h.co...|\n|         jhjhkk5.com|     999|         true|         9|         18|          true|89.847|66.794|jhjhkk5.com, a.jh...|ddft1.com, kkyytt...|yahoo.com, yy1235...|\n|            dzvdb.cn|     999|        false|       204|         84|          true|17.015|73.251|0axwj.dzvdb.cn, 0...|00ba6.net, 00ya0....|01iv0.net, 00mw7....|\n|          eaek25.com|     999|         true|        38|         15|          true|89.668|89.387|eaek25.com, a.eae...|blogspot.com, yww...|ticrf.org.tw, aa7...|\n|           bigtc.com|     999|         true|       207|         59|          true|58.686|97.281|bigtc.com, 0xc000...|jxxgqt.com, licha...|fcxn.net, directd...|\n|            557p.com|     999|         true|       106|         73|          true|87.182|96.667|557p.com, x.557p....|5ccs.com, ek59.co...|ek59.com, 4x2b.co...|\n|            557i.com|     999|         true|       109|         64|          true|87.182|96.837|557i.com, x.557i....|5ccs.com, ek59.co...|8bss.com, ex57.co...|\n|          jhfe34.com|     999|         true|        20|        455|          true|89.651|80.950|jhfe34.com, a.jhf...|kuku67.com, hffek...|fwwd5.com, 38cc.c...|\n|          sxdd32.com|     999|         true|        46|          2|          true|89.652|80.020|sxdd32.com, a.sxd...|a8aaa.com, blogsp...|ticrf.org.tw, yah...|\n|         diysoez.com|     999|         true|         8|         16|          true|95.429|63.991|diysoez.com, 007s...|blogspot.com, aiv...|yahoo.com, f701.c...|\n|            557b.com|     999|         true|       108|         70|          true|93.512|96.842|557b.com, 110001....|5ccs.com, ek59.co...|557h.com, 9ttu.co...|\n|         12sweet.com|     999|         true|         1|          4|          true|66.851|39.676|12sweet.com, a.12...|             yam.com|yahoo.com, ssapp1...|\n|           vipmp.com|     999|         true|       230|        254|          true|74.557|97.632|vipmp.com, 05shil...|fcxn.net, borog.c...|borog.com, yuding...|\n|englishvillage.or...|     999|         true|        11|       null|         false|90.801|54.685|englishvillage.or...|blogspot.com, blo...|                None|\n|            557h.com|     999|         true|       112|         61|          true|87.183|97.027|557h.com, x.557h....|blogspot.com, x03...|4x2b.com, x076.co...|\n|           hhry2.com|     999|         true|        11|         19|          true|88.209|69.252|hhry2.com, a.hhry...|blogspot.ca, ddft...|yahoo.com, ishow9...|\n|         jhjhkk7.com|     999|         true|         8|         17|          true|86.458|66.301|jhjhkk7.com, a.jh...|ddft1.com, ddft2....|kkyt257.com, ticr...|\n|          eaek23.com|     999|         true|        37|          5|          true|89.668|89.039|eaek23.com, a.eae...|blogspot.com, yww...|kmm3267.com, kkm3...|\n|         kefhk86.com|     999|         true|        17|        464|          true|89.651|76.575|kefhk86.com, a.ke...|kokyu58.com, blog...|hwe5.com, ks573.c...|\n|         kefhk87.com|     999|         true|        28|        309|          true|89.651|84.005|kefhk87.com, a.ke...|blogspot.hk, yyy5...|fwwd5.com, 38cc.c...|\n|          jhfr66.com|     999|         true|        12|         44|          true|86.223|76.750|jhfr66.com, a.jhf...|blogspot.com, klk...|yk272.com, kuku67...|\n|       tangcang57.cn|     999|        false|        91|       null|         false|49.346|78.175|0611rx.tangcang57...|zzejgvd.net, pack...|                None|\n|           me225.com|     999|         true|        97|        268|          true|88.579|94.149|me225.com, a1.me2...|e26a.com, lineav....|yahoo.com, bb1.id...|\n|          eaek21.com|     999|         true|        41|          5|          true|89.705|91.374|eaek21.com, a.eae...|tyuqw59.com, upot...|ticrf.org.tw, aa7...|\n|          jhfr67.com|     999|         true|        13|        455|          true|87.085|76.843|jhfr67.com, a.jhf...|kuku67.com, kkk26...|fwwd5.com, 38cc.c...|\n|            c26a.com|     999|         true|        96|         32|          true|87.852|94.119|c26a.com, a1.c26a...|goav173.info, v75...|ncc33.com, girl57...|\n|          hkfr54.com|     999|         true|        15|         38|          true|89.651|77.550|hkfr54.com, a.hkf...|blogspot.com, klk...|yk272.com, kuku67...|\n|          dtyyt1.com|     999|         true|        12|          3|          true|89.673|67.896|dtyyt1.com, a.dty...|blogspot.com, blo...|ticrf.org.tw, eet...|\n|       darani9pi.net|     999|         true|        13|       null|         false|77.126|81.983|darani9pi.net, 02...|airbbs.net, fc2.c...|                None|\n|        woxingma.com|     999|         true|       202|        230|          true|69.039|96.955|woxingma.com, 0xc...|butlercarcare.com...|yudingall.cn, wuz...|\n|          eaek22.com|     999|         true|        37|          2|          true|89.668|89.051|eaek22.com, a.eae...|blogspot.com, yww...|yahoo.com, ticrf....|\n|         jhjhkk6.com|     999|         true|         9|          4|          true|86.460|70.916|jhjhkk6.com, a.jh...|blogspot.com, ddf...|yahoo.com, aatk5....|\n|           azbuz.com|     999|         true|       460|       null|         false|99.827|98.870|azbuz.com, 06ct.a...|blogspot.com, sec...|                None|\n|          hkfr55.com|     999|         true|        16|        268|          true|89.651|79.461|hkfr55.com, a.hkf...|blogspot.com, klk...|cilis.net, kk69mm...|\n|           kgfs1.com|     999|         true|        11|         18|          true|86.460|68.908|kgfs1.com, a.kgfs...|ddft1.com, kkyytt...|yahoo.com, ishow9...|\n|           hhry1.com|     999|         true|        12|          3|          true|86.460|75.488|hhry1.com, a.hhry...|ddft1.com, kkyytt...|ygnm4.com, ticrf....|\n|        uthome51.com|     999|         true|       109|          9|          true|89.603|91.288|uthome51.com, a1....|bb198.net, hwe7.c...|gogo176.com, macr...|\n|           kgfs2.com|     999|         true|        12|         18|          true|89.943|69.972|kgfs2.com, a.kgfs...|blogspot.com, kte...|yahoo.com, ishow9...|\n|    seriousdeals.net|     999|         true|        82|          4|          true|99.363|98.953|seriousdeals.net,...|mundu.org, websit...|jzrputtbut.net, z...|\n|   taiwan-gis.org.tw|     999|         true|        11|       null|         false|90.801|54.685|taiwan-gis.org.tw...|blogspot.com, blo...|                None|\n|           ywkqg.com|     999|         true|         2|         13|          true|17.173|63.071|ywkqg.com, 1136p....|8r7.info, ywxinya...|youdao.com, iqiyi...|\n|              eur.vg|     999|        false|         3|       null|         false|97.258|64.636|a-flatwebdirector...|blogspot.com, blo...|                None|\n|            557j.com|     999|         true|       109|         79|          true|87.182|96.774|557j.com, x.557j....|blogspot.com, x03...|5eei.com, 557h.co...|\n|           01jf5.net|     999|         true|       278|        831|          true|22.132|78.303|01jf5.net, 0aigk....|00do4.net, 00dr6....|lusst.cn, 00dy2.n...|\n|          cbm665.com|     999|         true|        50|         19|          true|89.652|80.355|cbm665.com, a.cbm...|tyuqw59.com, bb19...|avmm088.com, hkk5...|\n|          dtyyt2.com|     999|         true|        15|          3|          true|89.673|80.812|dtyyt2.com, a.dty...|ddft1.com, kkyytt...|ticrf.org.tw, kky...|\n|           fhfu9.com|     999|         true|         5|         56|          true|85.730|61.397|fhfu9.com, a.fhfu...|ddft2.com, ddft4....|hwe5.com, zkt5.co...|\n|          blogia.com|    9989|         true|      5857|      69618|          true|99.991|99.962|blogia.com, 03am....|martinmaglio.com....|artear.com.ar, el...|\n|      visualgrep.com|  998136|         true|         6|         16|          true|46.114|88.601|visualgrep.com, 0...|visualdiffer.com,...|iciba.com, makepo...|\n|          acsjzs.com|    9980|         true|        28|        131|          true|47.381|64.399|acsjzs.com, 002.a...|rileblog.com, kin...|62670.xyz, gougou...|\n|            1id3.com|     998|         true|        13|       null|         false|67.364|85.120|1id3.com, x1.1id3...|av57.com, yam.com...|                None|\n|            nnt2.com|     998|         true|        17|       null|         false|75.594|72.095|nnt2.com, abenats...|ninja-web.net, li...|                None|\n|            asmen.cn|     998|         true|       488|        391|          true|64.744|99.587|asmen.cn, ab.asme...|40volts.com, daim...|hodxb.com, skojia...|\n|       multiforum.nl|     998|         true|       329|       null|         false|97.397|99.583|multiforum.nl, 30...|vindhetviahier.nl...|                None|\n|         sex-zone.pl|     998|         true|        41|          3|          true|93.957|89.142|sex-zone.pl, amat...|theglobe.net, wyk...|dotpay.pl, dyskre...|\n|        tpacc.org.tw|     998|         true|        18|       null|         false|90.930|58.475|tpacc.org.tw, 100...|dorfonlaw.org, bl...|                None|\n|            6ccs.com|     998|         true|       114|         66|          true|87.231|97.609|6ccs.com, l1.6ccs...|k327.com, 341b.co...|yahoo.com, 520liv...|\n|   uni-goettingen.de|     998|         true|      8488|       6143|          true|99.996|99.994|uni-goettingen.de...|kurt-bauer-geschi...|att.com, cell-sym...|\n|      lichanggen.net|     998|         true|       200|        256|          true|45.044|96.855|lichanggen.net, 1...|fcxn.net, borog.c...|borog.com, yuding...|\n| kaiguandianyuan.org|     998|         true|        11|         13|          true|17.194|81.238|kaiguandianyuan.o...|chinawjd.com, gun...|cnlinfo.net, soku...|\n|              deb.gs|     998|         true|        67|       null|         false|99.444|95.593|deb.gs, 001e5205....|newgrounds.com, h...|                None|\n|        miyanali.com|     998|         true|       230|         57|          true|98.284|96.794|miyanali.com, 091...|rdlj.ir, wegetari...|uploadfa.net, yar...|\n|     huafangfund.com|     998|         true|       210|        253|          true|45.647|96.995|huafangfund.com, ...|applemy.com, dyla...|borog.com, yuding...|\n|         advsoez.com|     998|         true|        12|          7|          true|96.061|66.333|advsoez.com, 007s...|blogspot.com, blo...|m085.com, e154.in...|\n|           yymm4.com|     998|         true|         3|       null|         false|26.426|55.600|yymm4.com, a.yymm...|ddft1.com, ddft4....|                None|\n|           fzint.net|     998|         true|       238|        304|          true|94.139|97.807|fzint.net, 0713dy...|blogspot.com, jxx...|xmzxyj.cn, borog....|\n|           yymm5.com|     998|         true|        11|         50|          true|89.673|69.654|yymm5.com, a.yymm...|ddft1.com, blogsp...|kkkyt1266.com, ut...|\n|     smfforfree3.com|     998|         true|       179|        773|          true|99.862|99.056|smfforfree3.com, ...|4umer.com, barene...|flickr.com, panti...|\n|         kuparts.com|     998|         true|       159|        137|          true|75.191|99.534|kuparts.com, act....|jxedt.com, sina.c...|jxedt.com, shushi...|\n|       yuzhiqing.net|     998|         true|       195|        239|          true|45.044|96.447|yuzhiqing.net, 13...|dylanlauren.net, ...|borog.com, yuding...|\n|            557m.com|     998|         true|       107|         77|          true|87.182|96.736|557m.com, x.557m....|k327.com, 341b.co...|8bss.com, ex57.co...|\n|           neon24.pl|     998|         true|       238|       2088|          true|99.769|98.949|neon24.pl, 101kot...|blogspot.com, zie...|utexas.edu, anima...|\n|      superqiche.com|     998|         true|       203|        242|          true|46.742|96.849|superqiche.com, 1...|butlercarcare.com...|borog.com, yuding...|\n|              cld.bz|     998|         true|      2918|         27|          true|99.954|99.990|cld.bz, 7thdaybap...|blogspot.com, coc...|arvo.org, cjca.ne...|\n|      wenwenzhuan.cn|     998|        false|         2|         13|          true|17.009|37.658|11qyl.wenwenzhuan...|pinpaibang.cc, 8r...|youdao.com, iqiyi...|\n|          hebkjxx.cn|    9972|         true|        68|         37|          true|64.102|96.529|hebkjxx.cn, 002vm...|xinwenge.org, prp...|zretc.com, admin5...|\n|       hydonghua.com|    9971|         true|        41|        131|          true|47.498|81.127|hydonghua.com, 00...|vidikupi.com, ton...|qv03.site, 60336....|\n|     starchapter.com|     997|         true|      1348|       5059|          true|98.523|99.970|starchapter.com, ...|bomacentralpa.com...|bomacentralpa.com...|\n|         fenzhi.info|     997|         true|       203|        231|          true|46.495|96.777|fenzhi.info, 0278...|butlercarcare.com...|qijiaqi.net, tang...|\n|         megaline.co|     997|         true|       132|         10|          true|98.689|97.797|megaline.co, 0022...|yahoo.com, apart....|opera.com, apple....|\n|            ffsav.cn|     997|         true|       191|         34|          true|45.044|96.313|ffsav.cn, 0571850...|jxxgqt.com, licha...|borog.com, vipmp....|\n|         minimals.ru|     997|         true|        12|          6|          true|91.293|99.170|minimals.ru, 0par...|blogspot.com, liv...|googleapis.com, o...|\n|             sbw6.cc|     997|        false|        10|       null|         false|31.968|39.355|01bh.sbw6.cc, 022...|grlfrnd.com, hiba...|                None|\n| annuairefrancais.fr|     997|         true|       111|         99|          true|99.786|98.641|annuairefrancais....|blogspot.com, kin...|socotam.com, blue...|\n|            2b1d.com|     997|         true|        22|         58|          true|86.289|87.778|2b1d.com, x1.2b1d...|blogspot.com, 2c8...|av104.tv, 8bss.co...|\n|raviolimakerstore...|     997|         true|         4|        133|          true|77.082|56.264|raviolimakerstore...|typepad.com, over...|ganzhiqi.cn, 300z...|\n|      dapinguo123.cn|     997|        false|         2|         13|          true|17.009|32.929|11g9s.dapinguo123...|8r7.info, dounanf...|youdao.com, iqiyi...|\n|            dbdh.xyz|     997|         true|         1|       null|         false|17.835|25.301|dbdh.xyz, adidas....|          mixpot.biz|                None|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\nonly showing top 100 rows\n\n91034040\n"}]},"apps":[],"jobName":"paragraph_1509721046353_-647219127","id":"20171103-135636_1283074493","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272","user":"anonymous","dateFinished":"2017-11-03T15:02:09+0000","dateStarted":"2017-11-03T15:00:31+0000"},{"text":"%pyspark\n\n# Save Example Summaries as GZIP files, approx 100MB each.\noutURI=\"s3://billsdata.net/CommonCrawl/domain_summaries_withexamples4/\"\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nexample_summary_df.coalesce(40).write.format('com.databricks.spark.csv').options(header='true', codec=codec).save(outURI) # Creates 94x23.8MB files by default","dateUpdated":"2017-11-03T15:03:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1509721046353_-647219127","id":"20171103-140215_1756777634","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:273","user":"anonymous","dateFinished":"2017-11-03T15:05:01+0000","dateStarted":"2017-11-03T15:03:12+0000"},{"text":"%pyspark\n\n# Load topic labels (from Tom 1)\nloadURL=\"s3://billsdata.net/CommonCrawl/topic_model_1024_files/cc_index_page_topic_labels/\"\ntopic_df=spark.read.load(loadURL)\ntopic_df.show(3)\nprint(topic_df.count())\ntopic_df.cache()\ntopic_df.rdd.getNumPartitions()","dateUpdated":"2017-11-03T15:05:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+\n|                host|                 url|              topic1|            score1|              topic2|             score2|              topic3|              score3|\n+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+\n|billives.typepad.com|http://billives.t...|one_may_january_l...|0.3004067571438536|news_business_dat...|0.17487022035440172|science_research_...| 0.12825866906681413|\n|     docs.oracle.com|http://docs.oracl...|nbsp_windows_quot...|0.7843980004795321|forums_member_lik...|0.14079996570227268|add_cart_buy_pric...|0.058564617674095515|\n|     e.il.tripod.com|http://e.il.tripo...|park_john_james_d...|0.7109430667614804|page_collection_l...|0.08726735225206302|state_church_coll...|  0.0481260760704955|\n+--------------------+--------------------+--------------------+------------------+--------------------+-------------------+--------------------+--------------------+\nonly showing top 3 rows\n\n53526\n171\n"}]},"apps":[],"jobName":"paragraph_1509721046354_-646064880","id":"20171023-081217_1250969967","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274","user":"anonymous","dateFinished":"2017-11-03T15:05:12+0000","dateStarted":"2017-11-03T15:05:07+0000"},{"text":"%pyspark\n\n# TODO: Convert hosts to PLDs using convert_hostname function from Paul 5.\n\n# TODO: If multiple rows per PLD, only use the one with the shortest URL.\n\n# TODO: Consider putting the three topic columns into a single column.\n\n# Join on host/PLD\nenrich_summary_df=example_summary_df.join(topic_df, example_summary_df.payLevelDomain==topic_df.host).drop(\"host\").drop(\"url\").drop(\"score1\").drop(\"score2\").drop(\"score3\")\nenrich_summary_df.dropDuplicates().sort(\"numHosts\",ascending=False).show()\nenrich_summary_df.count()","dateUpdated":"2017-11-03T15:25:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|              topic1|              topic2|              topic3|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|      uchastings.edu|      99|         true|      1986|       2131|          true|99.943|99.946|uchastings.edu, a...|anu.edu.au, backe...|coronertalk.com, ...|nbsp_windows_quot...|student_students_...|product_order_shi...|\n|      uchastings.edu|      99|         true|      1986|       2131|          true|99.943|99.946|uchastings.edu, a...|anu.edu.au, backe...|coronertalk.com, ...|nbsp_windows_quot...|product_order_shi...|student_students_...|\n|      uchastings.edu|      99|         true|      1986|       2131|          true|99.943|99.946|uchastings.edu, a...|anu.edu.au, backe...|coronertalk.com, ...|product_order_shi...|nbsp_windows_quot...|student_students_...|\n|            semo.edu|      96|         true|      1923|       2636|          true|99.987|99.939|semo.edu, 6.semo....|blogspot.com, cap...|dineoncampus.com,...|student_students_...|page_collection_l...|jobs_services_job...|\n|            semo.edu|      96|         true|      1923|       2636|          true|99.987|99.939|semo.edu, 6.semo....|blogspot.com, cap...|dineoncampus.com,...|student_students_...|page_collection_l...|com_http_www_goog...|\n|museumvictoria.co...|       9|         true|      3203|       1890|          true|99.952|99.968|museumvictoria.co...|beyondinfinity.co...|miceastmelb.com.a...|science_research_...|heritage_collecti...|email_password_ac...|\n|        ursuline.edu|      80|         true|       537|        723|          true|99.901|99.657|ursuline.edu, adf...|bainbridgetwp.com...|thearcade-clevela...|student_students_...|college_universit...|science_research_...|\n|        ursuline.edu|      80|         true|       537|        723|          true|99.901|99.657|ursuline.edu, adf...|bainbridgetwp.com...|thearcade-clevela...|student_students_...|college_universit...|jobs_services_job...|\n|        ursuline.edu|      80|         true|       537|        723|          true|99.901|99.657|ursuline.edu, adf...|bainbridgetwp.com...|thearcade-clevela...|law_state_court_t...|student_students_...|jobs_services_job...|\n| anglicansonline.org|       8|         true|      1331|      13797|          true|99.915|99.888|anglicansonline.o...|12ozprophet.com, ...|malenyanglicanpar...|pandora_islands_r...|page_collection_l...|state_church_coll...|\n| anglicansonline.org|       8|         true|      1331|      13797|          true|99.915|99.888|anglicansonline.o...|12ozprophet.com, ...|malenyanglicanpar...|state_church_coll...|london_san_usa_fr...|city_league_chapt...|\n| anglicansonline.org|       8|         true|      1331|      13797|          true|99.915|99.888|anglicansonline.o...|12ozprophet.com, ...|malenyanglicanpar...|information_use_s...|amp_words_word_le...|post_reply_report...|\n| anglicansonline.org|       8|         true|      1331|      13797|          true|99.915|99.888|anglicansonline.o...|12ozprophet.com, ...|malenyanglicanpar...|state_church_coll...|new_utah_virginia...|pandora_islands_r...|\n|      sonnettech.com|       8|         true|        82|       null|         false|99.942|99.903|sonnettech.com, j...|macworld.com.au, ...|highpoint-tech.co...|phone_mobile_ipho...|storage_focus_ple...|nbsp_windows_quot...|\n|         wordcamp.la|       8|         true|        36|          4|          true|92.502|99.106|wordcamp.la, 2009...|inmotionhosting.c...|inmotionhosting.c...|php_dan_yang_line...|heritage_collecti...|com_http_www_goog...|\n|            list.org|       8|         true|       217|         45|          true|98.797|99.976|list.org, bugs.li...|precisium.com.au,...|creativecommons.o...|nbsp_windows_quot...|science_research_...|post_reply_report...|\n|   chandrakantha.com|       8|         true|       621|        622|          true|98.760|99.480|chandrakantha.com...|blog.cz, writespi...|ganeshkanjira.com...|india_indian_news...|music_sheet_power...|information_use_s...|\n|      sonnettech.com|       8|         true|       928|        160|          true|99.942|99.903|sonnettech.com, j...|macworld.com.au, ...|highpoint-tech.co...|phone_mobile_ipho...|nbsp_windows_quot...|storage_focus_ple...|\n|            list.org|       8|         true|       845|         44|          true|98.797|99.976|list.org, bugs.li...|precisium.com.au,...|creativecommons.o...|nbsp_windows_quot...|science_research_...|post_reply_report...|\n| anglicansonline.org|       8|         true|      1331|      13797|          true|99.915|99.888|anglicansonline.o...|12ozprophet.com, ...|malenyanglicanpar...|state_church_coll...|science_research_...|one_may_january_l...|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n11495\n"}]},"apps":[],"jobName":"paragraph_1509721046354_-646064880","id":"20171023-081653_2145141554","dateCreated":"2017-11-03T14:57:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275","user":"anonymous","dateFinished":"2017-11-03T15:07:08+0000","dateStarted":"2017-11-03T15:05:20+0000"},{"text":"%pyspark\n","dateUpdated":"2017-11-03T14:57:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1509721046355_-646449629","id":"20171023-082228_1219608625","dateCreated":"2017-11-03T14:57:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:276"}],"name":"Paul 7 - enrich domain summary","id":"2CZCXTGMC","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}