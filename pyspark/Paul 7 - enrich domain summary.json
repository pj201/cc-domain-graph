{"paragraphs":[{"text":"%pyspark\n\n# Zeppelin notebook to enrich domain summaries (from Paul 5) with examples (from Paul 6)\n# and topic metadata (from Tom 1)\n# PJ - 13 December 2017\n\nimport boto\nfrom pyspark.sql.types import *\n\n#summary_df.unpersist()\n# Load Domain Summaries DF in Gzip files (from Paul 5)\n#loadURL=\"s3://billsdata.net/CommonCrawl/domain_summaries_withexamples4/\" # Split into 20 files (as opposed to domain_summaries7, which is 10)\nloadURL=\"s3://billsdata.net/CommonCrawl/domain_summaries7new/\" # Split into 20 files (as opposed to domain_summaries7, which is 10)\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nsummary_df=spark.read.format('com.databricks.spark.csv').options(header='true', codec=codec).load(loadURL)\nsummary_df.show(3)\nsummary_df.cache()\nsummary_df.rdd.getNumPartitions()","user":"anonymous","dateUpdated":"2017-12-13T12:32:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------+-------------+----------+-----------+--------------+------+------+\n|     payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|\n+-------------------+--------+-------------+----------+-----------+--------------+------+------+\n|vidaaomaximo.abbott|       1|         true|         5|       null|         false|84.277|67.760|\n|          praca.abc|       1|        false|         1|       null|         false|10.167|36.978|\n|            8301.ac|      15|        false|      null|          2|          true| 5.297| 5.297|\n+-------------------+--------+-------------+----------+-----------+--------------+------+------+\nonly showing top 3 rows\n\n10\n"}]},"apps":[],"jobName":"paragraph_1513168085605_1544122304","id":"20171023-080924_1586412256","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:32:29+0000","dateFinished":"2017-12-13T12:32:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3910"},{"text":"%pyspark\n\n# Load examples dataframe (from Paul 6)\nexamplesURI=\"s3://billsdata.net/CommonCrawl/domain_examples4new/\"\nexample_df=spark.read.load(examplesURI)\nexample_df.show(10)\nexample_df.cache()\nexample_df.rdd.getNumPartitions()","user":"anonymous","dateUpdated":"2017-12-13T12:29:54+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------------+--------------------+\n|                 PLD|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------------------+--------------------+--------------------+\n|0----------------...|[0---------------...|         [nomina.ru]|                null|\n|0--0-------------...|[0--0------------...|           [yapl.ru]|                null|\n|0--0------a4--bbb...|[0--0------a4--bb...|           [yapl.ru]|                null|\n|           0-0la.com|         [0-0la.com]|[artathina.gr, fa...|[gmpg.org, wordpr...|\n|            0-1du.cn|          [0-1du.cn]|            [39.net]|                null|\n|           0-3-6.com|         [0-3-6.com]|[8beauty.com, 211...|                null|\n|           0-3ani.ro|         [0-3ani.ro]|[adedir.info, cer...|                null|\n|           0-5-1.com|         [0-5-1.com]|    [allthecom.info]|                null|\n|       0-60times.net|     [0-60times.net]|[blogspot.com, wz...|                null|\n|            0-744.cn|          [0-744.cn]|     [wordpress.com]|                null|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n609\n"}]},"apps":[],"jobName":"paragraph_1513168085608_1542968057","id":"20171103-135448_580425054","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:29:54+0000","dateFinished":"2017-12-13T12:30:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3911"},{"text":"%pyspark\n\n# Remove square brackets from list output and remove Nulls\nimport boto\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import udf\ndef remove_brackets(egs):\n    return str(egs).replace('[', '').replace(']', '')\nprint(remove_brackets(\"[bla, bla]\"))\nudf_remove_brackets = udf(remove_brackets, StringType())\n\nexample_df2=example_df.filter(example_df.PLD.isNotNull()).withColumn(\"tmp\", udf_remove_brackets(\"exampleOutLinkPlds\")).drop(\"exampleOutLinkPlds\").withColumnRenamed(\"tmp\",\"exampleOutLinkPlds\")\nexample_df3=example_df2.withColumn(\"tmp\", udf_remove_brackets(\"exampleInLinkPlds\")).drop(\"exampleInLinkPlds\").withColumnRenamed(\"tmp\",\"exampleInLinkPlds\")\nexample_df4=example_df3.withColumn(\"tmp\", udf_remove_brackets(\"exampleHosts\")).drop(\"exampleHosts\").withColumnRenamed(\"tmp\",\"exampleHosts\").select(\"PLD\",\"exampleHosts\",\"exampleInLinkPlds\",\"exampleOutLinkPlds\")\nexample_df4.show(10)\nexample_df4.count()\n","user":"anonymous","dateUpdated":"2017-12-13T12:31:08+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"bla, bla\n+--------------------+--------------------+--------------------+--------------------+\n|                 PLD|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------------------+--------------------+--------------------+\n|0----------------...|0----------------...|           nomina.ru|                None|\n|0--0-------------...|0--0-------------...|             yapl.ru|                None|\n|0--0------a4--bbb...|0--0------a4--bbb...|             yapl.ru|                None|\n|           0-0la.com|           0-0la.com|artathina.gr, fab...|gmpg.org, wordpre...|\n|            0-1du.cn|            0-1du.cn|              39.net|                None|\n|           0-3-6.com|           0-3-6.com|8beauty.com, 2112...|                None|\n|           0-3ani.ro|           0-3ani.ro|adedir.info, cere...|                None|\n|           0-5-1.com|           0-5-1.com|      allthecom.info|                None|\n|       0-60times.net|       0-60times.net|blogspot.com, wz....|                None|\n|            0-744.cn|            0-744.cn|       wordpress.com|                None|\n+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n93458500\n"}]},"apps":[],"jobName":"paragraph_1513168085608_1542968057","id":"20171103-141703_260872707","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:31:08+0000","dateFinished":"2017-12-13T12:31:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3912"},{"text":"%pyspark\n\n# Join with Original summaries\nexample_df.unpersist()\nexample_summary_df=summary_df.join(example_df4, summary_df.payLevelDomain==example_df4.PLD).drop(\"PLD\")\nsummary_df.unpersist()\nexample_summary_df.dropDuplicates().sort(\"numHosts\",ascending=False).show(100)\nsummary_df.count()","user":"anonymous","dateUpdated":"2017-12-13T12:36:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag|hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\n|        show30946.cn|    9999|        false|       444|        198|          true|58.424|96.394|000j.show30946.cn...|bjjxly888.com, ch...|show37456.cn, jzd...|\n|     amurforever.com|    9999|         true|        66|          2|          true|92.026|84.998|amurforever.com, ...|an-34.ru, kvrddns...|incestmaster.com,...|\n|           dtzxp.com|    9999|         true|       701|        780|          true|36.335|93.884|dtzxp.com, 00j29....|gxirh.cn, sbrys.c...|ftelx.cn, lejili....|\n|        night8731.cn|    9999|        false|       477|        197|          true|58.426|97.532|0002.night8731.cn...|amehc.com, guarra...|jdyzjd.com, njbog...|\n|       year3422.loan|    9998|        false|       453|        198|          true|58.434|96.710|005x.year3422.loa...|show62797.cn, 958...|year8426.loan, ne...|\n|         igsonar.com|    9998|         true|      3077|       null|         false|97.613|99.987|igsonar.com, 1g4z...|bolsablindada.com...|                None|\n|         cmrbugov.cn|   99974|         true|      3727|       5849|          true|48.800|95.189|cmrbugov.cn, 004r...|arsewgov.cn, krcg...|atqaxgov.cn, bcjm...|\n|          bowlxj.com|    9997|         true|       698|        784|          true|36.412|93.878|bowlxj.com, 0015a...|ftelx.cn, lejili....|gwzxr.cn, dapeiba...|\n|           ms48.site|    9997|        false|       464|        198|          true|46.953|97.228|002k.ms48.site, 0...|news9765.cn, kai9...|881.jx.cn, 725.nm...|\n|           bf26.site|    9997|        false|       431|        199|          true|58.129|96.317|009x.bf26.site, 0...|chinajuwo.com, ol...|show35585.cn, yea...|\n|        yolasite.com|   99964|         true|     51558|      79349|          true|99.999|99.998|yolasite.com, 007...|bluetran.asia, ff...|humanechoice.com....|\n|           vv90.site|    9996|         true|       466|        196|          true|58.434|97.258|vv90.site, 005o.v...|hrm80.com, news23...|news2697.cn, 727....|\n|        navajoco.com|   99952|         true|      2292|       5476|          true|60.981|96.314|navajoco.com, 000...|bcwoa.com, beijin...|0npc.com, 1yyghm....|\n|            wcmpq.cn|    9995|        false|       695|        745|          true|36.350|93.843|0003a.wcmpq.cn, 0...|stmlx.cn, mjdlq.c...|jrjimg.cn, wqgmt....|\n|   qingdaowenxin.com|    9993|         true|       452|        168|          true|58.433|96.579|qingdaowenxin.com...|micro-sh.com, prc...|0571fa.com, link3...|\n|         fullsex.org|    9992|         true|        24|          5|          true|44.403|82.166|fullsex.org, 10-l...|kvrddns.com, nemp...|tltsoft.org, yand...|\n|             pr9z.cn|    9991|        false|        41|         45|          true| 6.288|93.997|xkcjfb.011b.pr9z....|ijhkk.cn, m0gd.cn...|kg0k.cn, p4cd.cn,...|\n|        chinacsw.com|    9990|         true|       256|         18|          true|98.481|95.325|chinacsw.com, 3ya...|hmwnxx.com, akva-...|grecosolar.com, r...|\n|         diysoez.com|     999|         true|        15|         16|          true|96.008|67.350|diysoez.com, 007s...|blogspot.fr, blog...|designsoez.com, e...|\n|          guzfa.work|     999|        false|         4|       null|         false|38.952|25.190|acgdv.guzfa.work,...|joystudiodesign.c...|                None|\n|         12sweet.com|     999|         true|      null|          4|          true| 4.860| 4.864|12sweet.com, a.12...|                None|                None|\n|          alabo.club|     999|         true|         7|         14|          true|47.895|31.436|alabo.club, 117ts...|chinamsg.org, chi...|iqiyi.com, mtime....|\n|            557h.com|     999|         true|       145|         59|          true|84.145|95.679|557h.com, x.557h....|k327.com, 8gff.co...|25xb.com, 557j.co...|\n|          2jink.info|     999|         true|         1|       null|         false|14.588|23.508|2jink.info, 3d-se...|            zexv.com|                None|\n|          dtyyt2.com|     999|         true|        17|       null|         false|84.935|82.524|dtyyt2.com, a.dty...|ddft4.com, xuite....|                None|\n|            557m.com|     999|         true|       138|         76|          true|84.085|95.014|557m.com, x.557m....|12s5.com, 557n.co...|6ccs.com, 399x.co...|\n|          jhfr66.com|     999|         true|        13|        386|          true|83.264|75.608|jhfr66.com, a.jhf...|hwe3.com, blogspo...|tppjtuu.com, dtkw...|\n|           kgfs1.com|     999|         true|        13|       null|         false|84.499|72.200|kgfs1.com, a.kgfs...|kkyt257.com, blog...|                None|\n|   hornyfreechat.com|     999|         true|         1|       null|         false|14.588|23.508|hornyfreechat.com...|            zexv.com|                None|\n|           aabh0.net|     999|         true|       273|        769|          true| 7.279|79.732|aabh0.net, 05n4ds...|01jd6.net, 00mp9....|hyhqp.cn, aabk8.n...|\n|            557b.com|     999|         true|       140|         69|          true|94.734|95.490|557b.com, 110001....|5ccs.com, 707x.co...|770h.com, ek59.co...|\n|       kkkyt1266.com|     999|         true|        57|         16|          true|84.502|83.949|kkkyt1266.com, 17...|ssstk2.com, knkbn...|rcapp999.com, app...|\n|          eaek21.com|     999|         true|        39|          6|          true|84.900|89.292|eaek21.com, a.eae...|bpop18.com, eaek2...|ticrf.org.tw, bjk...|\n|           00hk0.net|     999|         true|       276|        420|          true| 7.696|80.128|00hk0.net, 01dnf3...|00vt2.net, 00ll6....|01wn5.net, 00mo6....|\n|            557j.com|     999|         true|       140|         75|          true|84.085|95.162|557j.com, x.557j....|6ccs.com, 3kuu.co...|6ccs.com, 399x.co...|\n|           01iu6.net|     999|         true|       286|          3|          true| 7.697|81.486|01iu6.net, 00n6wx...|00dk5.net, 00au7....|fmscg.com, hicour...|\n|           01gy0.net|     999|         true|       275|          3|          true| 8.112|80.891|01gy0.net, 00ljhr...|00du0.net, 00jv5....|fmscg.com, hicour...|\n|          jhfr67.com|     999|         true|        14|        439|          true|83.265|75.709|jhfr67.com, a.jhf...|hwe3.com, blogspo...|livet173.com, tpw...|\n|       postfastr.com|     999|         true|        84|         94|          true|86.132|88.865|postfastr.com, ab...|gay-fetish-xxx.co...|ftc.gov, youtu.be...|\n|           01eu3.net|     999|         true|       282|          3|          true| 8.111|80.017|01eu3.net, 07qbsg...|00oo4.net, 00yb5....|fmscg.com, hicour...|\n|           01cm6.net|     999|         true|       280|        769|          true| 7.696|80.553|01cm6.net, 01p1zs...|01hz2.net, 00gx9....|00vh6.net, aabc0....|\n|         jhjhkk8.com|     999|         true|        10|          3|          true|84.499|68.954|jhjhkk8.com, a.jh...|ddft3.com, kkyt25...|ticrf.org.tw, yah...|\n|         aio260.info|     999|         true|        50|          9|          true|84.953|79.494|aio260.info, a.ai...|kk197.net, bb028....|6699.com.tw, rc99...|\n|              eur.vg|     999|        false|         3|       null|         false|97.193|64.567|a-flatwebdirector...|blogspot.com, blo...|                None|\n|           00ws0.net|     999|         true|       271|        887|          true| 8.110|80.324|00ws0.net, 02iq4l...|01gh0.net, aagq5....|00dg5.net, 00vd2....|\n|           merix.top|     999|        false|         2|       null|         false|47.002|24.558|28h.af.merix.top,...|forchel.ru, magic...|                None|\n|           bade8.com|     999|         true|      null|          5|          true| 4.749| 4.754|bade8.com, 02rh.b...|                None|                None|\n|     book2charme.com|     999|         true|        67|         18|          true|86.036|93.031|book2charme.com, ...|press-suvenir.ru,...|1-sexe.com, googl...|\n|            557n.com|     999|         true|       137|         88|          true|84.085|94.897|557n.com, x.557n....|5ccs.com, 707x.co...|6ccs.com, 399x.co...|\n|           00lh8.net|     999|         true|       284|          3|          true| 7.696|80.471|00lh8.net, 0clfg9...|01ee0.net, 00lw8....|fmscg.com, hicour...|\n|       artist.org.tw|     999|         true|        17|         10|          true|86.118|65.335|artist.org.tw, aa...|blogspot.pe, blog...|qq.com, qpic.cn, ...|\n|           01jd0.net|     999|         true|       280|          3|          true| 7.696|80.600|01jd0.net, 05wvma...|01bp1.net, 00ge1....|fmscg.com, hicour...|\n|           01kh3.net|     999|         true|       283|        424|          true|18.072|80.172|01kh3.net, 0blved...|00xw1.net, 01jc9....|01vq7.net, bnkmn....|\n|           00ux2.net|     999|         true|       275|          3|          true| 7.696|79.600|00ux2.net, 00h3hc...|00gc2.net, 00br0....|fmscg.com, hicour...|\n|   annonce-motard.fr|     999|         true|        55|       null|         false|84.496|85.837|annonce-motard.fr...|bdzoom.com, free-...|                None|\n|          ryi.com.tw|     999|         true|         1|       null|         false|59.030|28.499|ryi.com.tw, ym1.r...|      mysinablog.com|                None|\n|           00ss5.net|     999|         true|       283|        775|          true| 7.696|81.210|00ss5.net, 06umw....|00vz2.net, 01lc8....|00ce4.net, 00mt3....|\n|        kassaem.info|     999|         true|         1|       null|         false|14.588|23.508|kassaem.info, aap...|            zexv.com|                None|\n|           fhfu9.com|     999|         true|         7|         40|          true|84.499|60.963|fhfu9.com, a.fhfu...|blogspot.com, ddf...|yk272.com, ss55ds...|\n|          hkfr55.com|     999|         true|        16|        426|          true|83.265|77.885|hkfr55.com, a.hkf...|ss55ds.com, hwe4....|tppjtuu.com, dtkw...|\n|           sgpj.info|     999|         true|        73|       null|         false|35.775|74.551|sgpj.info, 001.sg...|9906.info, rou7tf...|                None|\n|      linyinxiang.cn|     999|        false|         3|         13|          true|27.706|26.560|097.linyinxiang.c...|dhhvd.cn, gzzzt.n...|chinaz.com, iqiyi...|\n|         kefhk87.com|     999|         true|        27|        430|          true|83.266|82.965|kefhk87.com, a.ke...|ss55ds.com, hwe4....|tppjtuu.com, dtkw...|\n|           yymm4.com|     999|         true|         5|       null|         false|67.066|56.574|yymm4.com, a.yymm...|ddft1.com, ddft3....|                None|\n|            557r.com|     999|         true|       133|         67|          true|84.085|94.646|557r.com, x.557r....|6ccs.com, 3kuu.co...|12s5.com, 853i.co...|\n|englishvillage.or...|     999|         true|        13|       null|         false|86.118|54.350|englishvillage.or...|blogspot.ie, blog...|                None|\n|           sk782.com|     999|         true|       170|        381|          true|66.778|96.060|sk782.com, ee00.s...|khkn17.com, khkn1...|fkuyku26.com, ftt...|\n|          tyu731.com|     999|         true|        53|       null|         false|84.905|79.724|tyu731.com, a.tyu...|zkt1.com, rttty18...|                None|\n|          dtyyt1.com|     999|         true|        15|          5|          true|84.999|70.495|dtyyt1.com, a.dty...|blogspot.hk, kkyt...|ticrf.org.tw, yah...|\n|            wrpsg.cn|     999|         true|        30|         45|          true|26.357|82.534|wrpsg.cn, 13drwsj...|tsskwiu.net.cn, p...|xlfqfgpb.cn, tany...|\n|           hhry1.com|     999|         true|        12|       null|         false|84.499|72.200|hhry1.com, a.hhry...|kkyytt88.com, ddf...|                None|\n|           00zt8.net|     999|         true|       275|        450|          true| 8.111|80.221|00zt8.net, 082vg....|01gq8.net, aadu9....|00op6.net, 00ps9....|\n|           00ut3.net|     999|         true|       269|       2041|          true| 8.182|80.006|00ut3.net, 0c3d2z...|00cb8.net, 01lt7....|azyhq.cn, xaxja.c...|\n|         jhjhkk7.com|     999|         true|        10|       null|         false|84.499|68.954|jhjhkk7.com, a.jh...|kkyytt88.com, ddf...|                None|\n|        iclean88.com|     999|         true|         8|          9|          true|14.246|96.131|iclean88.com, a08...|gcean.com, ilclea...|youtube.com, icle...|\n|           00or6.net|     999|         true|       280|       1166|          true| 7.697|80.552|00or6.net, 0a6nk3...|01iv9.net, 00tw0....|ifkvs.cn, osbtd.c...|\n|          eaek23.com|     999|         true|        37|         46|          true|84.900|88.947|eaek23.com, a.eae...|kmlll99.com, gg67...|mmuy61.com, uaea9...|\n|      zhuanyunhou.cn|     999|        false|         2|         13|          true| 8.021|31.279|1183h.zhuanyunhou...|szhfr.net, gzstp.net|cnlinfo.net, hc36...|\n|           00qf1.net|     999|         true|       285|        421|          true| 8.182|80.368|00qf1.net, 09qjyz...|00we3.net, 00gx1....|01dy0.net, 01jk4....|\n|          eaek22.com|     999|         true|        37|         77|          true|84.900|89.081|eaek22.com, a.eae...|jyyu72.com, kkrr2...|sedtd55.com, sad3...|\n|          hkfr54.com|     999|         true|        15|        410|          true|83.265|76.394|hkfr54.com, a.hkf...|kk9001.com, blogs...|zkt8.com, acme339...|\n|           hhry2.com|     999|         true|        14|       null|         false|85.309|76.296|hhry2.com, a.hhry...|blogspot.ca, fuuk...|                None|\n|         b2csoez.com|     999|         true|        18|          7|          true|94.923|75.587|b2csoez.com, 007s...|blogspot.ru, word...|f1.com.tw, e154.i...|\n|           fhfu8.com|     999|         true|         6|       null|         false|67.066|59.177|fhfu8.com, a.fhfu...|ddft3.com, ddft2....|                None|\n|           00jt2.net|     999|         true|       272|        859|          true| 7.694|80.319|00jt2.net, 0510cs...|00ei6.net, am156m...|01aj0.net, 01qs4....|\n|           00sw6.net|     999|         true|       275|          3|          true| 8.111|80.464|00sw6.net, 020vyb...|00dk5.net, aagp0....|fmscg.com, hicour...|\n|          yique8.com|     999|         true|         1|          5|          true| 6.443|87.292|yique8.com, 00sls...|          wang27.com|alizhizhuchi.com,...|\n|          jhfe34.com|     999|         true|        17|        441|          true|83.265|81.525|jhfe34.com, a.jhf...|uttyy.com, utt678...|fkuyku26.com, ut9...|\n|           00lh4.net|     999|         true|       283|        769|          true| 7.696|80.453|00lh4.net, 00rjzb...|01ji2.net, 00un6....|mz36g3.cn, pnzge....|\n|           kgfs2.com|     999|         true|        12|       null|         false|85.309|70.610|kgfs2.com, a.kgfs...|kkyytt88.com, ddf...|                None|\n|            557i.com|     999|         true|       140|         64|          true|84.085|95.555|557i.com, x.557i....|9e8c.com, 4prx.co...|rjj3.com, 557d.co...|\n|           aaab7.net|     999|         true|       274|        867|          true| 7.695|80.468|aaab7.net, 01lkjv...|00oc2.net, 00ui2....|01vb9.net, aabn7....|\n|         kefhk86.com|     999|         true|        17|        472|          true|83.265|75.509|kefhk86.com, a.ke...|blogspot.hk, blog...|zxzx358.com, kyyu...|\n|      campornhot.com|     999|         true|         1|       null|         false|14.588|23.508|campornhot.com, a...|            zexv.com|                None|\n|           00dz3.net|     999|         true|       274|       1495|          true| 8.112|80.472|00dz3.net, 0a4es3...|00cl8.net, aabo4....|qbbju.cn, 00cz7.n...|\n|   taiwan-gis.org.tw|     999|         true|        13|       null|         false|86.118|54.350|taiwan-gis.org.tw...|blogspot.pe, blog...|                None|\n|     zsmt1357.net.cn|     999|         true|        21|         46|          true|34.495|85.231|zsmt1357.net.cn, ...|mrlx6024.cn, pyss...|tobxm.cn, stqx246...|\n|      cyber-ninja.jp|     999|         true|      1207|       3674|          true|98.981|99.853|cyber-ninja.jp, 0...|kanasys.com, rkna...|blogmura.com, doo...|\n|         fbmm173.com|     999|         true|       105|         12|          true|84.908|91.360|fbmm173.com, a1.f...|kefhy74.com, jkp2...|mfc173.com, 6699l...|\n|         xunshou.com|     999|         true|       132|         37|          true|63.301|99.235|xunshou.com, 020z...|566job.com, 29ep....|huangye88.com, of...|\n+--------------------+--------+-------------+----------+-----------+--------------+------+------+--------------------+--------------------+--------------------+\nonly showing top 100 rows\n\n93111025\n"}]},"apps":[],"jobName":"paragraph_1513168085609_1542583308","id":"20171103-135636_1283074493","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T13:03:51+0000","dateFinished":"2017-12-13T13:07:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3913"},{"text":"%pyspark\n\n# Save Example Summaries as GZIP files, approx 100MB each.\noutURI=\"s3://billsdata.net/CommonCrawl/domain_summaries_withexamples4new/\"\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nexample_summary_df.coalesce(40).write.format('com.databricks.spark.csv').options(header='true', codec=codec).save(outURI) # Creates 94x23.8MB files by default\n#print(\"SAVE HERE FOR ONLY EXAMPLE SUMMARIES\")","user":"anonymous","dateUpdated":"2017-12-13T12:36:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513168085609_1542583308","id":"20171103-140215_1756777634","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T13:03:51+0000","dateFinished":"2017-12-13T13:09:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3914"},{"text":"%pyspark\n\n# Load topic labels (from Tom 1)\nloadURL=\"s3://billsdata.net/CommonCrawl/topic_model_32768_files/cc_index_page_topic_labels/\" # TODO - complete with all files!\ntopic_df=spark.read.load(loadURL)\ntopic_df.show(3)\nprint(topic_df.count())\ntopic_df.cache()\ntopic_df.rdd.getNumPartitions()","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+\n|             host|                 url|              topic1|            score1|              topic2|              score2|              topic3|              score3|\n+-----------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+\n|   allsizeweb.com|http://allsizeweb...|home_jul_new_cest...|0.3334087361447539|home_cushion_golf...|  0.2305628527052053|church_school_dir...|  0.1897973651904288|\n|ancestorguide.com|http://ancestorgu...|search_genealogy_...|0.9961374426189594|quotes_magazines_...|3.906793596073824E-5|one_new_like_time...|3.906692863996136...|\n|  archive.cor.org|http://archive.co...|one_new_like_time...|0.6437347327901176|information_cance...|  0.1712867757182201|one_home_like_lit...| 0.11463936819013947|\n+-----------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 3 rows\n\n945260\n250\n"}]},"apps":[],"jobName":"paragraph_1513168085609_1542583308","id":"20171023-081217_1250969967","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3915"},{"text":"%pyspark\n\n# From Paul 5.\n\n# Load in an uncompressed, partitioned format, for fast reading in the future\n#saveURI=\"s3://billsdata.net/CommonCrawl/hyperlinkgraph/cc-main-2017-may-jun-jul/domaingraph/vertices/\"\nsaveURI=\"s3://billsdata.net/CommonCrawl/hyperlinkgraph/cc-main-2017-aug-sep-oct/domaingraph/vertices/\"\n#pld_df.coalesce(64).write.save(saveURI) # Use all default options\npld_df=spark.read.load(saveURI)\npld_df.show(3)\npld_df.cache()\n#print(pld_df.count()) # Should have 91M domains","user":"anonymous","dateUpdated":"2017-12-13T12:33:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n| ID|  PLD|\n+---+-----+\n|  0|aaa.1|\n|  1|aaa.2|\n|  2|aaa.3|\n+---+-----+\nonly showing top 3 rows\n\nDataFrame[ID: string, PLD: string]\n"}]},"apps":[],"jobName":"paragraph_1513168085610_1543737555","id":"20171108-100011_1754193907","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:33:54+0000","dateFinished":"2017-12-13T12:33:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3916"},{"text":"%pyspark\n\n# From Paul 5.\n\n# Next, we'll construct a local dictionary from of all the PLDS (key is the PLD, value is the ID)\n# This is our truth-table of known PLDs that we'll use when counting hosts\n# Create a bloom filter using a pure python package (might be a little slow)\nfrom pybloom import BloomFilter\npld_bf = BloomFilter(capacity=94000000, error_rate=0.005) # was 91M\n\nfor row in pld_df.rdd.collect(): # limit(10000000) # TODO: Still bad (and exceeds spark.driver.maxResultSize with all rows)!\n    pld_bf.add(row['PLD'])\n\nprint(pld_df.rdd.take(3))\nprint(pld_df.rdd.take(3)[2]['PLD'])\n#pld_bf.add(pld_df.rdd.take(3)[2]['PLD'])\nprint(\"aaa.aaa\" in pld_bf) # Should be True\n\nimport sys\nprint(sys.getsizeof(pld_bf))\nprint(len(pld_bf)) # Should match number of items entered\n\n# Broadcast the bloom filter so it's available on all the slave nodes - we don't need to change\n# it any more so it's fine being immutable.\npld_bf_distrib=sc.broadcast(pld_bf)\n\nprint(\"aaa.aaa\" in pld_bf) # Should be true\nprint(\"aaa.aaa.bla\" in pld_bf) # Should be false\nprint(\"aaa.aaa\" in pld_bf_distrib.value) # Should be true\nprint(\"aaa.aaa.bla\" in pld_bf_distrib.value) # Should be false","user":"anonymous","dateUpdated":"2017-12-13T12:34:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(ID=u'0', PLD=u'aaa.1'), Row(ID=u'1', PLD=u'aaa.2'), Row(ID=u'2', PLD=u'aaa.3')]\naaa.3\nTrue\n64\n93110180\nTrue\nFalse\nTrue\nFalse\n"}]},"apps":[],"jobName":"paragraph_1513168085610_1543737555","id":"20171108-095927_1270326887","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:34:25+0000","dateFinished":"2017-12-13T13:03:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3917"},{"text":"%pyspark\n\n# From Paul 5.\n\nfrom pyspark.sql.functions import udf\n\n# Returns a Boolean to say whether PLD is a hostname in itself\ndef is_a_pld(hostname):\n    #if hostname in pld_lookup_table:\n    #if pld_lookup_table.filter(lambda a: a == hostname).count()>0:\n    if hostname in pld_bf_distrib.value:\n        return True\n    else:\n        return False\n        \n# Define a function to do the hostname->pld conversion, if the pld exists in our dictionary \ndef convert_hostname(hostname):\n    # Return hostname as-is, if this is already a PLD\n    #if hostname in pld_lookup_table:\n    #if pld_lookup_table.filter(lambda a: a == hostname).count()>0:\n    if hostname in pld_bf_distrib.value:\n        return hostname\n    # Otherwise we're going to have to split it up and test the parts\n    try:\n        parts=hostname.split('.')\n        if (len(parts)>4 and is_a_pld('.'.join(parts[0:4]))):\n            return '.'.join(parts[0:4])\n        if (len(parts)>3 and is_a_pld('.'.join(parts[0:3]))):\n            return '.'.join(parts[0:3])\n        if (len(parts)>2 and is_a_pld('.'.join(parts[0:2]))):\n            return '.'.join(parts[0:2])\n        if (len(parts)>1 and is_a_pld('.'.join(parts[0:1]))):\n            return '.'.join(parts[0:1])\n        return \"ERROR\" # Couldn't find a corresponding PLD - this should never happen!\n    except:\n        return \"ERROR\"\n\nudf_convert_hostname = udf(convert_hostname, StringType())\n\n# Test\nprint(convert_hostname(\"aaa.aaa\"))\nprint(is_a_pld(\"aaa.aaa\")) # Should be true","user":"anonymous","dateUpdated":"2017-12-13T12:34:40+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"aaa.aaa\nTrue\n"}]},"apps":[],"jobName":"paragraph_1513168085610_1543737555","id":"20171108-095830_940370411","dateCreated":"2017-12-13T12:28:05+0000","dateStarted":"2017-12-13T12:34:40+0000","dateFinished":"2017-12-13T13:03:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3918"},{"text":"%pyspark\n\n# Function to reverse hostnames\nfrom pyspark.sql.functions import udf\ndef reverse_domain(domain):\n    return '.'.join(reversed(domain.split('.')))\nprint(reverse_domain(\"com.facebook\"))\nudf_reverse_domain = udf(reverse_domain, StringType())\n\n# Convert hosts in Topic DF to PLDs using convert_hostname function from Paul 5.\ntopic_df2=topic_df.withColumn(\"pld\",udf_reverse_domain(udf_convert_hostname(udf_reverse_domain(\"host\")))) # Reverse the hostnames prior to lookup, then back again!\ntopic_df2.show(10)","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"facebook.com\n+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|                host|                 url|              topic1|            score1|              topic2|              score2|              topic3|              score3|                 pld|\n+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|      allsizeweb.com|http://allsizeweb...|home_jul_new_cest...|0.3334087361447539|home_cushion_golf...|  0.2305628527052053|church_school_dir...|  0.1897973651904288|      allsizeweb.com|\n|   ancestorguide.com|http://ancestorgu...|search_genealogy_...|0.9961374426189594|quotes_magazines_...|3.906793596073824E-5|one_new_like_time...|3.906692863996136...|   ancestorguide.com|\n|     archive.cor.org|http://archive.co...|one_new_like_time...|0.6437347327901176|information_cance...|  0.1712867757182201|one_home_like_lit...| 0.11463936819013947|             cor.org|\n|         belmont.edu|http://belmont.ed...|health_research_s...|0.6416289147432386|abstract_universi...| 0.18741124677241397|home_http_decembe...| 0.16830550303785022|         belmont.edu|\n|     bunnyhollow.org|http://bunnyhollo...|one_new_like_time...|0.6567567002030557|photos_card_peopl...|  0.1852641544451361|tigers_new_one_ho...| 0.15577726475682582|     bunnyhollow.org|\n| carletonbaptist.org|http://carletonba...|one_new_like_time...|0.6338257675386012|church_school_dir...|  0.2723894038191887|porn_teen_sex_fre...| 0.04366310910537767| carletonbaptist.org|\n|creatinglandscape...|http://creatingla...|one_new_like_time...|0.7011104095872868|viagra_buy_new_ha...| 0.14546600688309536|new_news_video_ho...| 0.07889037170640825|creatinglandscape...|\n|curriculumatocee....|http://curriculum...|one_new_like_time...|0.5657433039479814|viagra_buy_new_ha...| 0.42007094067818834|quotes_magazines_...|1.449495487316212E-4|          weebly.com|\n|dispatch.typepad.com|http://dispatch.t...|sex_november_free...| 0.714359099198136|new_skf_one_time_...| 0.12030658888601956|viagra_buy_new_ha...| 0.10112400773348668|         typepad.com|\n|      flyinmyear.com|http://flyinmyear...|one_new_like_time...|0.5129297365481966|one_may_comments_...| 0.38350403029976443|xen_devel_names_d...| 0.06831560972575888|      flyinmyear.com|\n+--------------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1513168085610_1543737555","id":"20171023-081653_2145141554","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3919"},{"text":"%pyspark\n\n# If multiple rows per PLD, only use the one with the shortest URL.\ndef url_len(url):\n    return len(url)\nprint(url_len(\"com.facebook.bla\"))\nudf_url_len = udf(url_len, IntegerType())\nfrom pyspark.sql.functions import col, desc\ntopic_df3=topic_df2.withColumn(\"url_len\", udf_url_len(\"url\"))\n#topic_df3.show(30)\n\n# Use window functions to filter to only the row with the shortest URL for each PLD\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import rank, col\nwindow = Window.partitionBy(topic_df3['pld']).orderBy(topic_df3['url_len']) # Ascending order of URL length\ntopic_df4=topic_df3.select('*', rank().over(window).alias('rank')).filter(col('rank') <= 1)\ntopic_df4.show(20)\n\n# TODO: Consider putting the three topic columns into a single column.","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"16\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------+----+\n|                host|                 url|              topic1|             score1|              topic2|              score2|              topic3|              score3|                 pld|url_len|rank|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------+----+\n|www.108divyadesam...|http://www.108div...|quotes_magazines_...| 0.5960511970669616|one_new_like_time...|   0.238302918414496|home_jul_new_cest...| 0.16046506000003882|   108divyadesam.org|     39|   1|\n|       1worldart.com|http://1worldart....|one_new_like_time...| 0.5816464041506926|milf_big_sex_vide...|  0.3275255789264762|linux_news_story_...| 0.07592288987113473|       1worldart.com|     34|   1|\n|       clfc.2itb.com|http://clfc.2itb....|linux_news_story_...| 0.5691525223795646|viagra_buy_new_ha...| 0.29267240173364856|file_new_pantyhos...| 0.09837755286729974|            2itb.com|     31|   1|\n| 3dstudioofdance.com|http://3dstudioof...|one_new_like_time...|0.45167691211960154|one_may_comments_...| 0.22249829419519343|quotes_magazines_...|   0.170511377764314| 3dstudioofdance.com|     37|   1|\n|      www.aatgwa.com|http://www.aatgwa...|die_der_messe_new...| 0.5275884734569005|case_university_n...|  0.4506593196120721|quotes_magazines_...|2.222580395038882E-4|          aatgwa.com|     32|   1|\n|     abglazing.co.uk|http://abglazing....|information_cance...|0.31015144515757487|linux_news_story_...| 0.20177094843447896|new_skf_one_time_...|  0.1655601360249711|     abglazing.co.uk|     33|   1|\n|        abject.co.uk|http://abject.co....|viagra_buy_new_ha...| 0.9883668807103371|quotes_magazines_...|1.176645419917233E-4|one_new_like_time...|1.176615081499055...|        abject.co.uk|     30|   1|\n|   aboproperties.com|http://abopropert...|quotes_magazines_...| 0.9951765727958441|one_new_like_time...|4.878607518554005E-5|viagra_buy_new_ha...|4.876597509981281E-5|   aboproperties.com|     35|   1|\n|    www.aboutflr.com|http://www.aboutf...|viagra_buy_new_ha...| 0.5124091181717997|one_new_like_time...|  0.4725232527676937|domain_dropping_n...|0.013908768061069145|        aboutflr.com|     40|   1|\n|www.aboutscotland...|http://www.abouts...|home_jul_new_cest...| 0.5877686439022313|one_time_law_like...|   0.226249538284614|one_home_like_lit...| 0.18388022093388207|   aboutscotland.com|     51|   1|\n|www.aboutscotland...|http://www.abouts...|home_jul_new_cest...| 0.5764491270179075|one_time_law_like...|   0.230016924487006|quotes_magazines_...| 0.19016997313568884|   aboutscotland.com|     51|   1|\n|accentartandframe...|http://accentarta...|one_may_comments_...| 0.7869842904335046|linux_news_story_...| 0.15543443063262327|quotes_magazines_...|5.883559871697778E-4|accentartandframe...|     49|   1|\n|     acecars4u.co.uk|http://acecars4u....|quotes_magazines_...| 0.4333941366754434|escorts_london_ce...| 0.29663188689870323|movies_defloratio...| 0.21800126989877586|     acecars4u.co.uk|     33|   1|\n|      aclcollect.com|http://aclcollect...|abstract_universi...| 0.5218417681176085|one_may_comments_...| 0.41728039102235587|escorts_london_ce...| 0.05190714230946218|      aclcollect.com|     32|   1|\n|      actdragons.org|http://actdragons...|one_new_like_time...| 0.5328770787493172|information_cance...|  0.4486544371933419|quotes_magazines_...|1.887088953919878...|      actdragons.org|     32|   1|\n|    adhikresorts.com|http://adhikresor...|information_cance...|0.47682611215723714|quotes_magazines_...| 0.20521581953367596|linux_news_story_...|  0.1282732776941214|    adhikresorts.com|     34|   1|\n|advance-engineeri...|http://advance-en...|information_cance...| 0.5398981430696999|skf_new_republic_...|   0.268708855572846|driver_research_o...| 0.18050711041742787|advance-engineeri...|     43|   1|\n|  advancedsilver.com|http://advancedsi...|var_white_functio...| 0.4033786946330825|health_research_s...| 0.21030902255517644|one_may_comments_...| 0.12083940533642275|  advancedsilver.com|     36|   1|\n| www.advcablebus.com|http://www.advcab...|abstract_universi...| 0.4476663404306233|viagra_buy_new_ha...|  0.2924060442954655|new_skf_one_time_...| 0.24839398242346133|     advcablebus.com|     37|   1|\n|            afda.org|http://afda.org/i...|linux_news_story_...|0.45134895717570506|new_said_would_ne...| 0.43514952752064395|search_genealogy_...| 0.10752104172328104|            afda.org|     26|   1|\n+--------------------+--------------------+--------------------+-------------------+--------------------+--------------------+--------------------+--------------------+--------------------+-------+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1513168085611_1543352806","id":"20171109-100957_801598180","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3920"},{"text":"%pyspark\n\n# Join on host/PLD\npld_df.unpersist()\ntopic_df2.unpersist()\ntopic_df3.unpersist()\n# PJ - 27/11 - previously was using example_summary_df\nenrich_summary_df=summary_df.join(topic_df4, summary_df.payLevelDomain==topic_df4.pld, \"leftOuter\")\\\n                            .drop(\"host\").drop(\"url\").drop(\"score1\").drop(\"score2\").drop(\"score3\").drop(\"url_len\").drop(\"rank\").drop(\"topic2\").drop(\"topic3\").drop(\"pld\")\\\n                            .withColumnRenamed(\"topic1\",\"exampleIndexPageTopics\").dropDuplicates()\nenrich_summary_df.sort(\"prRank\",ascending=False).show()\nprint(enrich_summary_df.count())","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"+--------------------+--------+-------------+----------+-----------+--------------+-------+------+--------------------+--------------------+--------------------+----------------------+\n|      payLevelDomain|numHosts|pldIsHostFlag|pldLinksIn|pldLinksOut|wasCrawledFlag| hcRank|prRank|        exampleHosts|   exampleInLinkPlds|  exampleOutLinkPlds|exampleIndexPageTopics|\n+--------------------+--------+-------------+----------+-----------+--------------+-------+------+--------------------+--------------------+--------------------+----------------------+\n|           zwire.com|      21|         true|      4315|       null|         false| 99.999|99.999|zwire.com, banner...|blogspot.com, car...|                None|                  null|\n|technologyreview.com|      50|         true|     30701|      12951|          true| 99.999|99.999|technologyreview....|macworld.com.au, ...|unimelb.edu.au, u...|                  null|\n|         wrenkin.net|       2|         true|        48|        147|          true| 98.800|99.999|wrenkin.net, moot...|blog.cz, crushing...|news1130.com, vid...|                  null|\n|         eczanet.com|       2|         true|         6|          6|          true| 99.316|99.999|eczanet.com, indi...|googleapis.com, r...|googleapis.com, y...|                  null|\n|   the-tournament.jp|       2|         true|        18|         14|          true| 99.371|99.999|the-tournament.jp...|saitama-soccer.jp...|notsobad.jp, twit...|                  null|\n|freecsstemplates.org|       1|         true|     17668|       null|         false| 99.999|99.999|freecsstemplates.org|uczymypolskiego.a...|                None|                  null|\n|      scalescale.com|       1|         true|        68|       null|         false| 98.486|99.999|      scalescale.com|damianschwyrz.de,...|                None|                  null|\n|         taka.com.vn|       4|         true|        50|         34|          true| 99.908|99.999|taka.com.vn, new....|blogspot.com, imo...|seomoz.org, actio...|                  null|\n|            acco.org|       5|         true|       966|        302|          true| 99.997|99.999|acco.org, give.ac...|baptistcancercent...|emergingmed.com, ...|                  null|\n|     boogenstein.com|       1|         true|        22|       null|         false| 98.788|99.999|     boogenstein.com|andybudd.com, apo...|                None|                  null|\n|     wigsforkids.org|       1|         true|       627|         23|          true| 99.998|99.999|     wigsforkids.org|yahoo.com, hudson...|bfrb.org, paypal....|                  null|\n|       savegrace.com|       1|         true|        11|          1|          true| 99.945|99.999|       savegrace.com|blogspot.com, tom...|         thegocf.org|                  null|\n|       carepages.com|       9|         true|      2696|       2465|          true| 99.998|99.999|carepages.com, as...|jbxstones.com.br,...|adventurecastlesa...|                  null|\n|            wpfr.net|       1|         true|     19658|       3915|          true| 98.351|99.999|            wpfr.net|autisme-en-action...|kriesi.at, issuep...|                  null|\n|         webnode.com|   82595|         true|     51261|      58312|          true| 99.999|99.999|webnode.com, 007g...|htl-klu.at, pfarr...|santacruzuno.com....|                  null|\n|          redhat.com|     863|         true|     14747|       7330|          true|100.000|99.999|redhat.com, 108.r...|perito.inf.br, uc...|unimelb.edu.au, t...|  abstract_universi...|\n|       adcouncil.org|      46|         true|      1887|        476|          true| 99.994|99.999|adcouncil.org, 2m...|blogspot.com, car...|lwr.org, lungforc...|                  null|\n|     basseyworld.com|       1|         true|        26|          1|          true| 99.947|99.999|     basseyworld.com|typepad.com, blog...|       pikavippim.fi|                  null|\n|        etracker.com|       8|         true|     16931|        112|          true| 99.910|99.999|etracker.com, app...|getraenke-welt.at...|embis.de, alkim.d...|                  null|\n|          redhat.com|     863|         true|     12802|      10785|          true|100.000|99.999|redhat.com, 108.r...|perito.inf.br, uc...|unimelb.edu.au, t...|  abstract_universi...|\n+--------------------+--------+-------------+----------+-----------+--------------+-------+------+--------------------+--------------------+--------------------+----------------------+\nonly showing top 20 rows\n\n91032617\n"},{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-3093619791748570289.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-3093619791748570289.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 9, in <module>\nNameError: name 'exampleIndexPageTopics' is not defined\n\n"}]},"apps":[],"jobName":"paragraph_1513168085611_1543352806","id":"20171108-114205_1373138614","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3921"},{"text":"%pyspark\n\n# Save Example Summaries as GZIP files, approx 100MB each.\noutURI=\"s3://billsdata.net/CommonCrawl/domain_summaries_withtopics4/\"\ncodec=\"org.apache.hadoop.io.compress.GzipCodec\"\nenrich_summary_df.coalesce(40).write.format('com.databricks.spark.csv').options(header='true', codec=codec).save(outURI) # coalesce(40) creates 94x23.8MB files by default","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1513168085611_1543352806","id":"20171023-082228_1219608625","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3922"},{"text":"%pyspark\n\nenrich_summary_df.filter(enrich_summary_df.exampleIndexPageTopics.isNotNull()).count()\n#help(enrich_summary_df.filter)","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"155853\n"}]},"apps":[],"jobName":"paragraph_1513168085612_1541429061","id":"20171109-105109_2094006765","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3923"},{"text":"%pyspark\n","dateUpdated":"2017-12-13T12:28:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1513168085612_1541429061","id":"20171127-095848_511383996","dateCreated":"2017-12-13T12:28:05+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3924"}],"name":"Paul 7 - enrich domain summary","id":"2CZYUKYDS","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}