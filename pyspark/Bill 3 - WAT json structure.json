{"paragraphs":[{"text":"%md\n\n<h1>WAT files - understanding the JSON structure</h1>","user":"anonymous","dateUpdated":"2017-08-28T12:52:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>WAT files - understanding the JSON structure</h1>\n"}]},"apps":[],"jobName":"paragraph_1503916506938_-103699246","id":"20170819-124213_1152118603","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T12:52:14+0000","dateFinished":"2017-08-28T12:52:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4179"},{"text":"%pyspark\n\nimport boto\nfrom boto.s3.key import Key\nfrom gzipstream import GzipStreamFile\nfrom pyspark.sql.types import *\nimport warc\n\nimport json\n\nwatlist = sc.textFile(\"s3://commoncrawl/crawl-data/CC-MAIN-2017-04/wat.paths.gz\")\nwatlist.cache()\n\nconn = boto.connect_s3(anon=True, host='s3.amazonaws.com')\nbucket = conn.get_bucket('commoncrawl')\n\ndef unpack(uri):\n    key_ = Key(bucket, uri)\n    file_ = warc.WARCFile(fileobj=GzipStreamFile(key_))\n    return file_\n\ndef mapper(id_, iterator):\n    \n    for uri in iterator:\n        file = unpack(uri)\n        for record in file:\n            try:\n                yield record['Content-Type']\n            except KeyError:\n                yield None\n\nnfiles = 16\nfiles = sc.parallelize(watlist.take(nfiles))\n\nct = files.mapPartitionsWithIndex(mapper)\nct.cache()\nprint(ct.count())\nprint(ct.countByValue())\nct.unpersist()","user":"anonymous","dateUpdated":"2017-08-28T11:26:42+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2621630\ndefaultdict(<type 'int'>, {'application/warc-fields': 16, 'application/json': 2621614})\nPythonRDD[131] at RDD at PythonRDD.scala:48\n"}]},"apps":[],"jobName":"paragraph_1503916506939_-104083995","id":"20170819-124213_1974489716","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:26:42+0000","dateFinished":"2017-08-28T11:28:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4180"},{"text":"%md\n\nLet's examine a sample of json records:","dateUpdated":"2017-08-28T10:35:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's examine a sample of json records:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506942_-105238242","id":"20170821-191626_1602179257","dateCreated":"2017-08-28T10:35:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4181"},{"text":"%pyspark\n\nfrom pprint import pprint\n\ndef json_mapper(id_, iterator):\n    conn = boto.connect_s3(anon=True, host='s3.amazonaws.com')\n    bucket = conn.get_bucket('commoncrawl')\n\n    for uri in iterator:\n        key_ = Key(bucket, uri)\n        file_ = warc.WARCFile(fileobj=GzipStreamFile(key_))\n\n        for record in file_:\n            if record['Content-Type'] == 'application/json':\n                record = json.loads(record.payload.read())\n\n                try:\n                    yield record\n                except KeyError:\n                    yield None\n\nnrecords = 100\nsample = files.\\\n        mapPartitionsWithSplit(json_mapper).\\\n        take(nrecords)\n\npprint(sample[1])","user":"anonymous","dateUpdated":"2017-08-28T11:29:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{u'Container': {u'Compressed': True,\n                u'Filename': u'CC-MAIN-20170116095119-00000-ip-10-171-10-70.ec2.internal.warc.gz',\n                u'Gzip-Metadata': {u'Deflate-Length': u'393',\n                                   u'Footer-Length': u'8',\n                                   u'Header-Length': u'10',\n                                   u'Inflated-CRC': u'2084246495',\n                                   u'Inflated-Length': u'566'},\n                u'Offset': u'431'},\n u'Envelope': {u'Actual-Content-Length': u'213',\n               u'Block-Digest': u'sha1:T2IJZ2UKM44CKVZAPHICBH7EKI22CVBJ',\n               u'Format': u'WARC',\n               u'Payload-Metadata': {u'Actual-Content-Type': u'application/http; msgtype=request',\n                                     u'HTTP-Request-Metadata': {u'Entity-Digest': u'sha1:3I42H3S6NNFQ2MSVX7XZKYAYSCX5QBYJ',\n                                                                u'Entity-Length': u'0',\n                                                                u'Entity-Trailing-Slop-Bytes': u'0',\n                                                                u'Headers': {u'Accept': u'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n                                                                             u'Accept-Encoding': u'x-gzip, gzip, deflate',\n                                                                             u'Host': u'03online.com',\n                                                                             u'User-Agent': u'CCBot/2.0 (http://commoncrawl.org/faq/)'},\n                                                                u'Headers-Length': u'211',\n                                                                u'Request-Message': {u'Method': u'GET',\n                                                                                     u'Path': u'/news/3383',\n                                                                                     u'Version': u'HTTP/1.0'}},\n                                     u'Trailing-Slop-Length': u'4'},\n               u'WARC-Header-Length': u'349',\n               u'WARC-Header-Metadata': {u'Content-Length': u'213',\n                                         u'Content-Type': u'application/http; msgtype=request',\n                                         u'WARC-Date': u'2017-01-16T11:09:13Z',\n                                         u'WARC-IP-Address': u'136.243.111.229',\n                                         u'WARC-Record-ID': u'<urn:uuid:8d22f2ba-db4a-4f0c-b9f4-d2b162a9805a>',\n                                         u'WARC-Target-URI': u'http://03online.com/news/3383',\n                                         u'WARC-Type': u'request',\n                                         u'WARC-Warcinfo-ID': u'<urn:uuid:0787aacb-6253-4aad-9432-520b454438bb>'}}}\n"}]},"apps":[],"jobName":"paragraph_1503916506942_-105238242","id":"20170820-151806_1677347656","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:29:32+0000","dateFinished":"2017-08-28T11:29:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4182"},{"text":"%md\n\nWe see that the field <tt>['Envelope']['WARC-Header-Metadata']['WARC-Target-URI']</tt> contains the URI of the current web page:","user":"anonymous","dateUpdated":"2017-08-28T11:31:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We see that the field <tt>['Envelope']['WARC-Header-Metadata']['WARC-Target-URI']</tt> contains the URI of the current web page:</p>\n"}]},"apps":[],"jobName":"paragraph_1503919824806_-569650422","id":"20170828-113024_545335905","dateCreated":"2017-08-28T11:30:24+0000","dateStarted":"2017-08-28T11:31:20+0000","dateFinished":"2017-08-28T11:31:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4183"},{"text":"%pyspark\n\nfor rec in sample:\n    try:\n        print(rec['Envelope']['WARC-Header-Metadata']['WARC-Target-URI'])\n    except KeyError:\n        print(\"\")","user":"anonymous","dateUpdated":"2017-08-28T11:31:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nhttp://03online.com/news/3383\nhttp://03online.com/news/3383\nhttp://03online.com/news/3383\nhttp://03online.com/news/pochemu_sineyut_guby/2013-2-28-4347\nhttp://03online.com/news/pochemu_sineyut_guby/2013-2-28-4347\nhttp://03online.com/news/pochemu_sineyut_guby/2013-2-28-4347\nhttp://03online.com/news/temnye_krugi_pod_glazami/2014-7-17-28934\nhttp://03online.com/news/temnye_krugi_pod_glazami/2014-7-17-28934\nhttp://03online.com/news/temnye_krugi_pod_glazami/2014-7-17-28934\nhttp://05sese.com/news/class/160566.html\nhttp://05sese.com/news/class/160566.html\nhttp://05sese.com/news/class/160566.html\nhttp://08.od.ua/gazovoe_i_otopitelnoe_oborudovanie/kotly_elektricheskie/teplo_holod\nhttp://08.od.ua/gazovoe_i_otopitelnoe_oborudovanie/kotly_elektricheskie/teplo_holod\nhttp://08.od.ua/gazovoe_i_otopitelnoe_oborudovanie/kotly_elektricheskie/teplo_holod\nhttp://08.od.ua/turisticheskie_uslugi/sanatorii/4_v_kompaniya_ooo\nhttp://08.od.ua/turisticheskie_uslugi/sanatorii/4_v_kompaniya_ooo\nhttp://08.od.ua/turisticheskie_uslugi/sanatorii/4_v_kompaniya_ooo\nhttp://0lik.ru/templates/fotomontag/115531-free-arthur-radley-website-template.html\nhttp://0lik.ru/templates/fotomontag/115531-free-arthur-radley-website-template.html\nhttp://0lik.ru/templates/fotomontag/115531-free-arthur-radley-website-template.html\nhttp://0lik.ru/templates/frame-for-photos/152042-novogodnyaya-ramka-dlya-fotoshop-prazdnik-priblizhaetsya.html\nhttp://0lik.ru/templates/frame-for-photos/152042-novogodnyaya-ramka-dlya-fotoshop-prazdnik-priblizhaetsya.html\nhttp://0lik.ru/templates/frame-for-photos/152042-novogodnyaya-ramka-dlya-fotoshop-prazdnik-priblizhaetsya.html\nhttp://0lik.ru/templates/frame-for-photos/169085-kollekciya-iz-3-svadebnyx-albomov.html\nhttp://0lik.ru/templates/frame-for-photos/169085-kollekciya-iz-3-svadebnyx-albomov.html\nhttp://0lik.ru/templates/frame-for-photos/169085-kollekciya-iz-3-svadebnyx-albomov.html\nhttp://1.163.com/detail/2924-401120986.html\nhttp://1.163.com/detail/2924-401120986.html\nhttp://1.163.com/detail/2924-401120986.html\nhttp://1.163.com/user/index.do?t=1484219210718143649609&cid=143649609\nhttp://1.163.com/user/index.do?t=1484219210718143649609&cid=143649609\nhttp://1.163.com/user/index.do?t=1484219210718143649609&cid=143649609\nhttp://100.ufc.com/watch.html\nhttp://100.ufc.com/watch.html\nhttp://100.ufc.com/watch.html\nhttp://10000km.com/2016/11/07/suihanki/\nhttp://10000km.com/2016/11/07/suihanki/\nhttp://10000km.com/2016/11/07/suihanki/\nhttp://1000designs.ru/clipart/50764-ekzoticheskiy-skrap-nabor-cveta-indii.html\nhttp://1000designs.ru/clipart/50764-ekzoticheskiy-skrap-nabor-cveta-indii.html\nhttp://1000designs.ru/clipart/50764-ekzoticheskiy-skrap-nabor-cveta-indii.html\nhttp://1000designs.ru/fotoframes/46483-letnyaya-ramka-na-dve-fotografii-lesnoe-priklyuchenie.html\nhttp://1000designs.ru/fotoframes/46483-letnyaya-ramka-na-dve-fotografii-lesnoe-priklyuchenie.html\nhttp://1000designs.ru/fotoframes/46483-letnyaya-ramka-na-dve-fotografii-lesnoe-priklyuchenie.html\nhttp://1000ff.de/neues-spielen/\nhttp://1000ff.de/neues-spielen/\nhttp://1000ff.de/neues-spielen/\nhttp://1000form.ru/kollektivnyj-dogovor/\nhttp://1000form.ru/kollektivnyj-dogovor/\nhttp://1000form.ru/kollektivnyj-dogovor/\nhttp://1000fragrances.blogspot.com/2005_08_01_archive.html\nhttp://1000fragrances.blogspot.com/2005_08_01_archive.html\nhttp://1000fragrances.blogspot.com/2005_08_01_archive.html\nhttp://1000mg.jp/archives/51394215.html\nhttp://1000mg.jp/archives/51394215.html\nhttp://1000mg.jp/archives/51394215.html\nhttp://1001download.com/tag/%D8%AF%D8%A7%D9%86%D9%84%D9%88%D8%AF-%D8%A8%D8%A7%D8%B2%DB%8C-%D8%A7%DA%86-%D8%AF%DB%8C-%D8%A8%D8%B1%D8%A7%DB%8C%DB%8C-%D8%A7%D9%86%D8%AF%D8%B1%D9%88%DB%8C%D8%AF/\nhttp://1001download.com/tag/%D8%AF%D8%A7%D9%86%D9%84%D9%88%D8%AF-%D8%A8%D8%A7%D8%B2%DB%8C-%D8%A7%DA%86-%D8%AF%DB%8C-%D8%A8%D8%B1%D8%A7%DB%8C%DB%8C-%D8%A7%D9%86%D8%AF%D8%B1%D9%88%DB%8C%D8%AF/\nhttp://1001download.com/tag/%D8%AF%D8%A7%D9%86%D9%84%D9%88%D8%AF-%D8%A8%D8%A7%D8%B2%DB%8C-%D8%A7%DA%86-%D8%AF%DB%8C-%D8%A8%D8%B1%D8%A7%DB%8C%DB%8C-%D8%A7%D9%86%D8%AF%D8%B1%D9%88%DB%8C%D8%AF/\nhttp://1001in365.blogspot.com/2012/10/flower-garden-image-340.html?m=1\nhttp://1001in365.blogspot.com/2012/10/flower-garden-image-340.html?m=1\nhttp://1001in365.blogspot.com/2012/10/flower-garden-image-340.html?m=1\nhttp://100formul.ru/reactions/152\nhttp://100formul.ru/reactions/152\nhttp://100formul.ru/reactions/152\nhttp://1019ampradio.cbslocal.com/tag/travel/\nhttp://1019ampradio.cbslocal.com/tag/travel/\nhttp://1019ampradio.cbslocal.com/tag/travel/\nhttp://1020115.vkrugudruzei.ru/\nhttp://1020115.vkrugudruzei.ru/\nhttp://1020115.vkrugudruzei.ru/\nhttp://103.2.132.3/newsdetail.asp?ID=44\nhttp://103.2.132.3/newsdetail.asp?ID=44\nhttp://103.2.132.3/newsdetail.asp?ID=44\nhttp://1037theloon.com/tags/w-a-s-p/\nhttp://1037theloon.com/tags/w-a-s-p/\nhttp://1037theloon.com/tags/w-a-s-p/\nhttp://1061thetwister.iheart.com/articles/entertainment-news-104651/trick-pony-reunites-following-sevenyear-split-12059522/\nhttp://1061thetwister.iheart.com/articles/entertainment-news-104651/trick-pony-reunites-following-sevenyear-split-12059522/\nhttp://1061thetwister.iheart.com/articles/entertainment-news-104651/trick-pony-reunites-following-sevenyear-split-12059522/\nhttp://1079thebear.iheart.com/onair/ken-dashow-32036/epic-fails-for-july-2014-12639622/\nhttp://1079thebear.iheart.com/onair/ken-dashow-32036/epic-fails-for-july-2014-12639622/\nhttp://1079thebear.iheart.com/onair/ken-dashow-32036/epic-fails-for-july-2014-12639622/\nhttp://107jamz.com/events-lake-charles/icd-10-cm-coding-bootcamp/24-july-2013/\nhttp://107jamz.com/events-lake-charles/icd-10-cm-coding-bootcamp/24-july-2013/\nhttp://107jamz.com/events-lake-charles/icd-10-cm-coding-bootcamp/24-july-2013/\nhttp://10diet.net/zapravlyat-salati-s-polzoi-dlya-zdorovya.html\nhttp://10diet.net/zapravlyat-salati-s-polzoi-dlya-zdorovya.html\nhttp://10diet.net/zapravlyat-salati-s-polzoi-dlya-zdorovya.html\nhttp://10torrent.net/6499-resident-evil-5-gold-edition-2015.html\nhttp://10torrent.net/6499-resident-evil-5-gold-edition-2015.html\nhttp://10torrent.net/6499-resident-evil-5-gold-edition-2015.html\nhttp://10w40.ru/p353940.html\nhttp://10w40.ru/p353940.html\nhttp://10w40.ru/p353940.html\nhttp://10w40.ru/p386315.html\nhttp://10w40.ru/p386315.html\nhttp://10w40.ru/p386315.html\n"}]},"apps":[],"jobName":"paragraph_1503916506942_-105238242","id":"20170826-113445_1000367901","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:31:23+0000","dateFinished":"2017-08-28T11:31:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4184"},{"text":"%md\n\nLater we'll want to aggregate records by web domain, and use the information in the individual page records to build features of the domains.\n\nLet's build a <tt>traverse</tt> function to output a lists of keys of a json record together with its tree depth and boolean is-leaf indicator:","user":"anonymous","dateUpdated":"2017-08-28T11:33:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Later we'll want to aggregate records by web domain, and use the information in the individual page records to build features of the domains.</p>\n<p>Let's build a <tt>traverse</tt> function to output a lists of keys of a json record together with its tree depth and boolean is-leaf indicator:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506942_-105238242","id":"20170825-163732_842972386","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:33:56+0000","dateFinished":"2017-08-28T11:33:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4185"},{"text":"%pyspark\n\nfrom __future__ import print_function\n\ndef traverse(js, depth, keys):\n    if type(js) is dict:\n        d = depth + 1\n        for k in js.keys():\n            if type(js[k]) is not dict: leaf = 1\n            else: leaf = 0\n            keys += [(d,leaf,k)]\n            depth, keys = traverse(js[k], d, keys)\n    return depth, keys\n\njs = sample[1]\ndepth, keys = traverse(js, 0, [])\nkeys.sort()\n\nprint(len(keys), \"json keys:\")\nfor x in keys:\n    print(x)","user":"anonymous","dateUpdated":"2017-08-28T11:33:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"41 json keys:\n(1, 0, u'Container')\n(1, 0, u'Envelope')\n(2, 0, u'Gzip-Metadata')\n(2, 0, u'Payload-Metadata')\n(2, 0, u'WARC-Header-Metadata')\n(2, 1, u'Actual-Content-Length')\n(2, 1, u'Block-Digest')\n(2, 1, u'Compressed')\n(2, 1, u'Filename')\n(2, 1, u'Format')\n(2, 1, u'Offset')\n(2, 1, u'WARC-Header-Length')\n(3, 0, u'HTTP-Request-Metadata')\n(3, 1, u'Actual-Content-Type')\n(3, 1, u'Content-Length')\n(3, 1, u'Content-Type')\n(3, 1, u'Deflate-Length')\n(3, 1, u'Footer-Length')\n(3, 1, u'Header-Length')\n(3, 1, u'Inflated-CRC')\n(3, 1, u'Inflated-Length')\n(3, 1, u'Trailing-Slop-Length')\n(3, 1, u'WARC-Date')\n(3, 1, u'WARC-IP-Address')\n(3, 1, u'WARC-Record-ID')\n(3, 1, u'WARC-Target-URI')\n(3, 1, u'WARC-Type')\n(3, 1, u'WARC-Warcinfo-ID')\n(4, 0, u'Headers')\n(4, 0, u'Request-Message')\n(4, 1, u'Entity-Digest')\n(4, 1, u'Entity-Length')\n(4, 1, u'Entity-Trailing-Slop-Bytes')\n(4, 1, u'Headers-Length')\n(5, 1, u'Accept')\n(5, 1, u'Accept-Encoding')\n(5, 1, u'Host')\n(5, 1, u'Method')\n(5, 1, u'Path')\n(5, 1, u'User-Agent')\n(5, 1, u'Version')\n"}]},"apps":[],"jobName":"paragraph_1503916506943_-105622991","id":"20170825-155337_160300286","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:33:59+0000","dateFinished":"2017-08-28T11:33:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4186"},{"text":"%md\n\nThis json record has 41 keys. Let's see how that varies over all the records:","dateUpdated":"2017-08-28T10:35:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>This json record has 41 keys. Let's see how that varies over all the records:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506943_-105622991","id":"20170825-142817_1633926003","dateCreated":"2017-08-28T10:35:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4187"},{"text":"%pyspark\n\nfrom collections import Counter\nimport matplotlib.pyplot as plt\n\ndef get_json_keys(id_, iterator):\n\n    for uri in iterator:\n        \n        file = unpack(uri)\n        for record in file:\n            if record['Content-Type'] == 'application/json':\n                record = json.loads(record.payload.read())\n\n                try:\n                    _,k = traverse(record, 0, [])\n                    \"\"\" \n                    yield the shape of the record:\n                    \"\"\"\n                    yield dict(Counter([x[0:2] for x in k]))\n                except KeyError:\n                    yield None\n\njson_keys = files.mapPartitionsWithIndex(get_json_keys)\njson_shape = json_keys.collect()\n\ntotal_shape = [sum(x.values()) for x in json_shape]\n\nplt.hist(total_shape, bins=30)\nplt.yscale('log')\nplt.show()","user":"anonymous","dateUpdated":"2017-08-28T11:34:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div style='width:auto;height:auto'><img src=data:image/png;base64,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ceONN8af/MmfdLokAKAgCtXBGh0dje7u7iiXy4uuT01NRblcjr6+vhgfH4+IiI0bN8bevXvjy1/+chw+fLgT5QIABVWogLVr166YmppadO38+fMxNjYWhw4diuPHj8fExERMT09HRMR9990X27dvj2q12olyAYCCKlTA2rZtW3R1dS26duzYsejv74+enp5YvXp1DA8Px+Tkz35P1gc+8IE4fPhwTExMdKJcAKCgCr8Hq9VqRU9Pz8LrUqkUR48ejYcffjjuvffeeP755+OGG2646PsbjUY0Go2IiJibm1v2egGAK1/hA9bF3HDDDf9rsHpZvV6Per0eERGVSmW5ywIACqDwAatUKsXs7OzC61arFaVSKdc9ms1mNJvNOHPmTOryAIACKnzA2rJlS5w4cSJarVZcc801cfDgwdi7d2+ue9RqtajVajpYAMuod/fkkt43Mz6UuBL4xRVqk/vIyEhs3bo1Tp48GaVSKfbt2xdr1qyJPXv2xODgYAwMDMSOHTtyB6Vmsxn1el0HCwBoS6E6WAcOHHjF69Vq9Rc6ikEHCwDIo1AdLACAy0GhOljLxSZ3ACAPAasNRoRXlqVulAWAVIwIAQAS08FqgxEhAJCHDlYbarVaNBqNWLt2badLAQCuAAIWAEBiAhYAQGL2YLXBHiwAIA8drDbYgwUA5CFgAQAkJmABACRmD1Yb7MECAPLQwWqDPVgAQB4CFgBAYgIWAEBiAhYAQGICFgBAYp4ibIOnCAGAPHSw2uApQgAgDx0sgCtE7+7JJb1vZnwocSXAq9HBAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASMwxDW1w0CgAkIcOVhscNAoA5KGDBcAVzQGsXI50sAAAEhOwAAASE7AAABITsAAAEhOwAAASE7AAABITsAAAElux52B94xvfiAceeCDOnDkTt99+e9xyyy2dLgkAKIhCdbBGR0eju7s7yuXyoutTU1NRLpejr68vxsfHIyLid37nd6LRaESj0YgDBw50olwAoKAKFbB27doVU1NTi66dP38+xsbG4tChQ3H8+PGYmJiI6enphf/+mc98Ju64445LXSoAUGCFCljbtm2Lrq6uRdeOHTsW/f390dPTE6tXr47h4eGYnJyMLMviE5/4RAwODsZ73vOeDlUMABRRoQLWK2m1WtHT07PwulQqRavVirvvvjse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/NM//VM8+OCDnS5p2V24cCEeffTR+NjHPhb/9V//FV1dXfHXf/3XnS7rknnhhRfivvvui507d3a6lEviySefjL/7u7+Lp556Kn70ox/F2bNn46GHHup0WctuYGAgPvrRj8aNN94YN954Y2zatClWrVrV6bK4AghYy+hXfuVXYmhoKH7wgx/EqVOn4sKFCxHxs9RfKpU6XF1a//Zv/xb33Xdf9Pb2xgc/+MH453/+5/j4xz9e+HW/7E1velNERHR3d8dtt90Wjz76aKxbty7m5uYi4md/A+zu7u5kicn19PTE+vXr473vfW9ERNx2223xne98p/DrftmhQ4fi3e9+d1xzzTUREYVf9yOPPBLve9/7Yt26dbF69er43d/93fiXf/mXFfEdv+OOO+J73/tePPLII/GWt7wlrrvuusJ/3j/vYmstlUoxOzu78HNF/fyXSsBK7NSpU/Hss89GRMRPf/rTePDBB2Pz5s3xG7/xG/HNb34zIiL2798f27dv72SZyX32s5+NVqsVMzMzcc8998RNN90U+/fvL/y6IyLOnj0b586dW/j3qamp2LhxY1Sr1di/f39EFHPtPT09cfXVV8fJkycjIuLIkSNx3XXXFX7dLztw4MDCeDAiCr/ua6+9Nv7zP/8zzp07F1mWxZEjR+Id73jHiviOv/wLin/84x/HwYMHY3h4uPCf98+72Fqr1Wp85StfiYiI6enpuOqqqxaNDFe8Tm8CK5rvfve72Tvf+c5sYGAge/vb35598pOfzLIsy5588snsve99b9bf35/t3Lkze/755ztb6DL61re+tfAU4UpY95NPPplt2rQpGxgYyN72trdlf/EXf5FduHAhO3XqVHbzzTdn5XI5u/nmm7PTp093utTkHn/88ez666/P+vr6ssHBwezUqVMrYt3PPfdc1tXVlT3zzDML11bCuv/yL/8yu/baa7MNGzZkO3fuzM6ePbsivuO/+Zu/mW3atCl797vfnT300ENZlhX38/7gBz+YvelNb8pe+9rXZuvXr8/+8R//8aJrvXDhQnbHHXdkfX192Tvf+c7s0Ucf7XD1lxcnuQMAJGZECACQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQmIAFAJCYgAUAkJiABQCQ2P8BPaw5YPILYX0AAAAASUVORK5CYII= style='width=auto;height:auto'><div>\n"}]},"apps":[],"jobName":"paragraph_1503916506943_-105622991","id":"20170825-160754_1739746979","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:34:22+0000","dateFinished":"2017-08-28T11:40:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4188"},{"text":"%md\n\nLet's break down this histogram by tree depth and leaf vs node:","dateUpdated":"2017-08-28T10:35:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's break down this histogram by tree depth and leaf vs node:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506943_-105622991","id":"20170825-164508_1933838769","dateCreated":"2017-08-28T10:35:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4189"},{"text":"%pyspark\n\nfrom __future__ import print_function\n\nmaxdepth = max([k[0] for y in json_shape for k in y.keys()])\n\nfor depth in range(1, 1+maxdepth):\n    print(\"Depth\", depth)\n    \n    nodeshape = dict(Counter([x[(d,l)]  for x in json_shape for (d,l) in x.keys() if d==depth and l==0]))\n    if len(nodeshape.items()) > 0: \n        print(\"nodes:\")\n        for i in nodeshape.items(): print(i)\n    \n    leafshape = dict(Counter([x[(d,l)]  for x in json_shape for (d,l) in x.keys() if d==depth and l==1]))\n    if len(leafshape.items()) > 0: \n        print(\"leaves:\")\n        for i in leafshape.items(): print(i)","user":"anonymous","dateUpdated":"2017-08-28T11:40:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Depth 1\nnodes:\n(2, 2621614)\nDepth 2\nnodes:\n(3, 2621614)\nleaves:\n(7, 2621614)\nDepth 3\nnodes:\n(1, 2621614)\nleaves:\n(18, 438254)\n(19, 435612)\n(15, 1747748)\nDepth 4\nnodes:\n(2, 885764)\n(3, 861968)\nleaves:\n(8, 16)\n(3, 873866)\n(4, 1747036)\n(5, 696)\nDepth 5\nnodes:\n(1, 858865)\nleaves:\n(4, 3)\n(5, 19)\n(6, 21)\n(7, 874214)\n(8, 9938)\n(9, 25099)\n(10, 50078)\n(11, 68303)\n(12, 94931)\n(13, 119531)\n(14, 144338)\n(15, 111709)\n(16, 82245)\n(17, 46950)\n(18, 30538)\n(19, 19775)\n(20, 15514)\n(21, 11353)\n(22, 7871)\n(23, 6686)\n(24, 5782)\n(25, 3048)\n(26, 3003)\n(27, 6221)\n(28, 3731)\n(29, 2712)\n(30, 569)\n(31, 231)\n(32, 129)\n(33, 62)\n(34, 37)\n(35, 2)\n(36, 20)\n(37, 45)\n(38, 158)\n(39, 1595)\n(40, 129)\n(41, 297)\n(42, 573)\n(43, 164)\n(44, 13)\n(45, 68)\n(46, 8)\n(54, 18)\n(56, 1)\nDepth 6\nleaves:\n(1, 6645)\n(2, 10224)\n(3, 33612)\n(4, 727800)\n(5, 80486)\n"}]},"apps":[],"jobName":"paragraph_1503916506944_-119858700","id":"20170825-164057_309392600","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T11:40:44+0000","dateFinished":"2017-08-28T11:41:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4190"},{"text":"%md\n\nIn other words:\n\n<b>At depth 1:</b> \nall records have two nodes \n<tt>\n(1, 0, u'Container') \n(1, 0, u'Envelope')\n</tt>\n\n<b> At depth 2:</b>\nall records have 3 nodes and 7 leaves \n<tt>\n(2, 0, u'Gzip-Metadata')\n(2, 0, u'Payload-Metadata')\n(2, 0, u'WARC-Header-Metadata')\n(2, 1, u'Actual-Content-Length')\n(2, 1, u'Block-Digest')\n(2, 1, u'Compressed')\n(2, 1, u'Filename')\n(2, 1, u'Format')\n(2, 1, u'Offset')\n(2, 1, u'WARC-Header-Length')\n</tt>\n\n<b> At depth 3:</b>\nall records a single 3 node\n<tt>\n(3, 0, u'HTTP-Request-Metadata')\n</tt>\nbut 15, 18 or 19 leaves.\n\n<b> At depth 4:</b>\n2 or 3 nodes and 3,4,5 or 8 leaves.\n\n<b> At depth 5 and 6:</b>\n\nDepth 5 is where most of the leaf variance is; there's a single (optional) node \n<tt>\n['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Head']\n</tt> \nwith 1,2,3,4,5 leaves under it at depth 6.\n\nLet's eyeball a record with a larger number of json keys:","user":"anonymous","dateUpdated":"2017-08-28T12:40:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In other words:</p>\n<p><b>At depth 1:</b>\n<br  />all records have two nodes\n<br  /><tt>\n<br  />(1, 0, u'Container')\n<br  />(1, 0, u'Envelope')\n<br  /></tt></p>\n<p><b> At depth 2:</b>\n<br  />all records have 3 nodes and 7 leaves\n<br  /><tt>\n<br  />(2, 0, u'Gzip-Metadata')\n<br  />(2, 0, u'Payload-Metadata')\n<br  />(2, 0, u'WARC-Header-Metadata')\n<br  />(2, 1, u'Actual-Content-Length')\n<br  />(2, 1, u'Block-Digest')\n<br  />(2, 1, u'Compressed')\n<br  />(2, 1, u'Filename')\n<br  />(2, 1, u'Format')\n<br  />(2, 1, u'Offset')\n<br  />(2, 1, u'WARC-Header-Length')\n<br  /></tt></p>\n<p><b> At depth 3:</b>\n<br  />all records a single 3 node\n<br  /><tt>\n<br  />(3, 0, u'HTTP-Request-Metadata')\n<br  /></tt>\n<br  />but 15, 18 or 19 leaves.</p>\n<p><b> At depth 4:</b>\n<br  />2 or 3 nodes and 3,4,5 or 8 leaves.</p>\n<p><b> At depth 5 and 6:</b></p>\n<p>Depth 5 is where most of the leaf variance is; there's a single (optional) node\n<br  /><tt>\n<br  />['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Head']\n<br  /></tt>\n<br  />with 1,2,3,4,5 leaves under it at depth 6.</p>\n<p>Let's eyeball a record with a larger number of json keys:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506944_-119858700","id":"20170825-164001_1207498255","dateCreated":"2017-08-28T10:35:06+0000","dateStarted":"2017-08-28T12:40:10+0000","dateFinished":"2017-08-28T12:40:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4191"},{"text":"%pyspark\n\nnkeys = 80\n\ndef f(rec): \n    _,k = traverse(rec, 0, [])\n    return len(k)\n\nsample = files.\\\n        mapPartitionsWithSplit(json_mapper).\\\n        filter(lambda rec: f(rec) > nkeys).\\\n        take(100)\n\nrec = sample[0]\ndepth, keys = traverse(rec, 0, [])\nkeys.sort()\n\nprint(len(keys))\nfor x in keys:\n    print(x)","dateUpdated":"2017-08-28T12:40:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"82\n(1, 0, u'Container')\n(1, 0, u'Envelope')\n(2, 0, u'Gzip-Metadata')\n(2, 0, u'Payload-Metadata')\n(2, 0, u'WARC-Header-Metadata')\n(2, 1, u'Actual-Content-Length')\n(2, 1, u'Block-Digest')\n(2, 1, u'Compressed')\n(2, 1, u'Filename')\n(2, 1, u'Format')\n(2, 1, u'Offset')\n(2, 1, u'WARC-Header-Length')\n(3, 0, u'HTTP-Response-Metadata')\n(3, 1, u'Actual-Content-Type')\n(3, 1, u'Content-Length')\n(3, 1, u'Content-Type')\n(3, 1, u'Deflate-Length')\n(3, 1, u'Footer-Length')\n(3, 1, u'Header-Length')\n(3, 1, u'Inflated-CRC')\n(3, 1, u'Inflated-Length')\n(3, 1, u'Trailing-Slop-Length')\n(3, 1, u'WARC-Block-Digest')\n(3, 1, u'WARC-Concurrent-To')\n(3, 1, u'WARC-Date')\n(3, 1, u'WARC-IP-Address')\n(3, 1, u'WARC-Payload-Digest')\n(3, 1, u'WARC-Record-ID')\n(3, 1, u'WARC-Target-URI')\n(3, 1, u'WARC-Type')\n(3, 1, u'WARC-Warcinfo-ID')\n(4, 0, u'HTML-Metadata')\n(4, 0, u'Headers')\n(4, 0, u'Response-Message')\n(4, 1, u'Entity-Digest')\n(4, 1, u'Entity-Length')\n(4, 1, u'Entity-Trailing-Slop-Bytes')\n(4, 1, u'Headers-Length')\n(5, 0, u'Head')\n(5, 1, u'Accept-Ranges')\n(5, 1, u'Age')\n(5, 1, u'Cache-Control')\n(5, 1, u'Connection')\n(5, 1, u'Content-Length')\n(5, 1, u'Content-Type')\n(5, 1, u'Date')\n(5, 1, u'Expires')\n(5, 1, u'Last-Modified')\n(5, 1, u'Links')\n(5, 1, u'Reason')\n(5, 1, u'ServedBy')\n(5, 1, u'Server')\n(5, 1, u'Set-Cookie')\n(5, 1, u'Status')\n(5, 1, u'Vary')\n(5, 1, u'Version')\n(5, 1, u'X-Actual-URL')\n(5, 1, u'X-CDN')\n(5, 1, u'X-Cache')\n(5, 1, u'X-FORWARDED-FOR')\n(5, 1, u'X-Handled-By')\n(5, 1, u'X-Iinfo')\n(5, 1, u'X-Original-Request')\n(5, 1, u'X-Passed-To')\n(5, 1, u'X-Passed-To-BeforeDispatch')\n(5, 1, u'X-Passed-To-DLL')\n(5, 1, u'X-Passed-To-PostProcessResponse')\n(5, 1, u'X-Returned-From')\n(5, 1, u'X-Returned-From-BeforeDispatch')\n(5, 1, u'X-Returned-From-DLL')\n(5, 1, u'X-Returned-From-PostProcessResponse')\n(5, 1, u'X-Served-By')\n(5, 1, u'X-UA-Device')\n(5, 1, u'X-Varnish')\n(5, 1, u'X-Varnish-beresp-grace')\n(5, 1, u'X-Varnish-beresp-status')\n(5, 1, u'X-Varnish-beresp-ttl')\n(5, 1, u'x-stale')\n(6, 1, u'Link')\n(6, 1, u'Metas')\n(6, 1, u'Scripts')\n(6, 1, u'Title')\n"}]},"apps":[],"jobName":"paragraph_1503916506944_-119858700","id":"20170825-102508_245866590","dateCreated":"2017-08-28T10:35:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4192","user":"anonymous","dateFinished":"2017-08-28T12:41:22+0000","dateStarted":"2017-08-28T12:40:28+0000"},{"text":"%md\n\nLet's look, at depth 5, at the <tt>Head</tt> node and a leaf <tt>Links</tt>, which contain relevant information about outgoing links:","dateUpdated":"2017-08-28T12:44:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's look, at depth 5, at the <tt>Head</tt> node and a leaf <tt>Links</tt>, which contain relevant information about outgoing links:</p>\n"}]},"apps":[],"jobName":"paragraph_1503916506944_-119858700","id":"20170826-111539_1550906698","dateCreated":"2017-08-28T10:35:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4193","user":"anonymous","dateFinished":"2017-08-28T12:44:00+0000","dateStarted":"2017-08-28T12:44:00+0000"},{"text":"%pyspark\n\nfrom pprint import pprint\n\nnode = rec['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Head']\n\n_,k = traverse(node, 0, [])\n\nfor x in k:\n    print(x)\n    print(type(node[x[2]]))\n    if type(node[x[2]]) == list: print(len(node[x[2]]))\n\npprint(node)","dateUpdated":"2017-08-28T12:42:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(1, 1, u'Metas')\n<type 'list'>\n23\n(1, 1, u'Link')\n<type 'list'>\n4\n(1, 1, u'Scripts')\n<type 'list'>\n8\n(1, 1, u'Title')\n<type 'unicode'>\n{u'Link': [{u'path': u'LINK@/href',\n            u'rel': u'canonical',\n            u'url': u'http://www.ardmoreite.com/article/20121123/OBITUARIES/121129904'},\n           {u'path': u'LINK@/href',\n            u'rel': u'stylesheet',\n            u'type': u'text/css',\n            u'url': u'https://fonts.googleapis.com/css?family=Oswald:300,400|Roboto+Condensed|Crimson+Text:400,700|Rubik:700,900'},\n           {u'path': u'LINK@/href',\n            u'rel': u'stylesheet',\n            u'type': u'text/css',\n            u'url': u'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css'},\n           {u'path': u'LINK@/href',\n            u'rel': u'stylesheet',\n            u'type': u'text/css',\n            u'url': u'//cdn.gatehousemedia.com/assets/css/201701111832/default.min.css'}],\n u'Metas': [{u'content': u'IE=edge', u'http-equiv': u'X-UA-Compatible'},\n            {u'content': u'width=device-width, initial-scale=1.0',\n             u'name': u'viewport'},\n            {u'content': u'The Daily Ardmoreite',\n             u'property': u'og:site_name'},\n            {u'content': u'text/html; charset=utf-8',\n             u'http-equiv': u'Content-Type'},\n            {u'content': u'7E15F9269E2CE66F2A488ABB04B5015E',\n             u'name': u'msvalidate.01'},\n            {u'content': u'Gregory Young, age 52, passed away on November 20, 2012, in Ardmore, Okla. Services will be held at 10 a.m., Saturday, November 24, 2012, in The Chapel at Griffin~Hillcrest with Pastor Frank Young officiating. Interment will follow at Hillcrest Memorial Park, Ardmore, Okla.Gregory was born on September 7, 1960, in Electra, Texas, to Robert and Gwen (Bray) Young.He is a graduate of Denver City, Texas, schools. He went to work for Denver City Electric Motor Company as an electric motor repairman. ',\n             u'name': u'description'},\n            {u'content': u'143435942403889', u'property': u'fb:app_id'},\n            {u'content': u'art-D3839DD4-34EF-44E1-9312-9A73CF5FA638-pub382',\n             u'property': u'tout:article:id'},\n            {u'content': u'20121123T00:01:00Z', u'property': u'bt:pubDate'},\n            {u'content': u'20121122T23:58:00Z', u'property': u'bt:modDate'},\n            {u'content': u'', u'property': u'bt:author'},\n            {u'content': u'summary_large_image', u'name': u'twitter:card'},\n            {u'content': u'http://www.ardmoreite.com/storyimage/OK/20121123/OBITUARIES/121129904/AR/0/AR-121129904.jpg&MaxW=1200&MaxH=630',\n             u'name': u'twitter:image:src'},\n            {u'content': u'http://www.ardmoreite.com/storyimage/OK/20121123/OBITUARIES/121129904/AR/0/AR-121129904.jpg',\n             u'property': u'og:image'},\n            {u'content': u'552', u'property': u'og:image:width'},\n            {u'content': u'768', u'property': u'og:image:height'},\n            {u'content': u'@Ardmoreite', u'name': u'twitter:site'},\n            {u'content': u'Gregory Young', u'name': u'twitter:title'},\n            {u'content': u'Gregory Young, age 52, passed away on November 20, 2012, in Ardmore, Okla. Services will be held at 10 a.m., Saturday, November 24, 2012, in The Chapel at Griffin~Hillcrest with Pastor Frank Young officiating. Interment will follow at Hillcrest Memorial Park, Ardmore, Okla.Gregory was born on September 7, 1960, in Electra, Texas, to Robert and Gwen (Bray) Young.He is a graduate of Denver City, Texas, schools. He went to work for Denver City Electric Motor Company as an electric motor repairman. ',\n             u'name': u'twitter:description'},\n            {u'content': u'Gregory Young', u'property': u'og:title'},\n            {u'content': u'http://www.ardmoreite.com/article/20121123/OBITUARIES/121129904',\n             u'property': u'og:url'},\n            {u'content': u'article', u'property': u'og:type'},\n            {u'content': u'Gregory Young, age 52, passed away on November 20, 2012, in Ardmore, Okla. Services will be held at 10 a.m., Saturday, November 24, 2012, in The Chapel at ',\n             u'property': u'og:description'}],\n u'Scripts': [{u'path': u'SCRIPT@/src',\n               u'url': u'//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js?20160411-3'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js?20160411-3'},\n              {u'path': u'SCRIPT@/src',\n               u'type': u'text/javascript',\n               u'url': u'http://www.ardmoreite.com/Global/js/mobile/rwd/verticals.js?20160411-4'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdn.gatehousemedia.com/gh-sites/global/ads/ads.js'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdn.gatehousemedia.com/assets/1.5.324/ext.global.min.js'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdn.gatehousemedia.com/assets/1.5.324/int.global.min.js'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdn.gatehousemedia.com/assets/1.5.324/article.global.min.js'},\n              {u'path': u'SCRIPT@/src',\n               u'url': u'//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js?201604-1'}],\n u'Title': u' Gregory Young - Obituaries - The Daily Ardmoreite - Ardmore, OK'}\n"}]},"apps":[],"jobName":"paragraph_1503916506945_-120243449","id":"20170825-145052_2136690156","dateCreated":"2017-08-28T10:35:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4194","user":"anonymous","dateFinished":"2017-08-28T12:42:23+0000","dateStarted":"2017-08-28T12:42:23+0000"},{"text":"%md\n\n<tt>Links</tt> is a json leaf, but behaves like a node in that its value is a list of dicts:","user":"anonymous","dateUpdated":"2017-08-28T12:45:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1503924253608_87997054","id":"20170828-124413_250379213","dateCreated":"2017-08-28T12:44:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5729","dateFinished":"2017-08-28T12:45:03+0000","dateStarted":"2017-08-28T12:45:03+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><tt>Links</tt> is a json leaf, but behaves like a node in that its value is a list of dicts:</p>\n"}]}},{"text":"%pyspark\n\nnode = rec['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Links']\n\n_,k = traverse(node, 0, [])\n\nfor x in node2:\n    pprint.pprint(x)","dateUpdated":"2017-08-28T10:35:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{u'path': u'IMG@/src',\n u'url': u'http://b.scorecardresearch.com/p?c1=2&c2=9289482&cv=2.0&cj=1'}\n{u'path': u'A@/href', u'url': u'#'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'News',\n u'url': u'http://www.ardmoreite.com/news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Sports',\n u'url': u'http://www.ardmoreite.com/sports'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Entertainment',\n u'url': u'http://www.ardmoreite.com/entertainment'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Life',\n u'url': u'http://www.ardmoreite.com/lifestyle'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Obituaries',\n u'url': u'http://www.ardmoreite.com/obituaries'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'E-Edition',\n u'url': u'http://ardmoredailyardmoreite.ok.newsmemory.com/'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Cars',\n u'url': u'http://www.ardmoreite.com/section/cars'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Jobs',\n u'url': u'http://www.ardmoreite.com/jobs'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Homes',\n u'url': u'http://www.ardmoreite.com/realestate'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Classifieds',\n u'url': u'http://www.marketplaceadsonline.com/marketplace/OKArd'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'title': u'The Daily Ardmoreite Facebook',\n u'url': u'http://www.facebook.com/pages/The-Ardmoreite/143707431292?ref=nf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'title': u'The Daily Ardmoreite Twitter',\n u'url': u'http://www.twitter.com/Ardmoreite'}\n{u'path': u'A@/href',\n u'title': u'The Daily Ardmoreite RSS Feed',\n u'url': u'http://www.ardmoreite.com/section/feed'}\n{u'path': u'A@/href',\n u'title': u'Contact The Daily Ardmoreite',\n u'url': u'http://www.ardmoreite.com/contact'}\n{u'path': u'A@/href', u'text': u'log in', u'url': u'/subscribe'}\n{u'method': u'get', u'path': u'FORM@/action', u'url': u'/search'}\n{u'alt': u'The Daily Ardmoreite',\n u'path': u'IMG@/src',\n u'url': u'http://www.ardmoreite.com/Global/images/head/nameplate/ok-ardmore_logo.png'}\n{u'path': u'A@/href', u'url': u'http://www.ardmoreite.com'}\n{u'path': u'IMG@/src',\n u'url': u'http://www.ardmoreite.com/storyimage/OK/20121123/OBITUARIES/121129904/AR/0/AR-121129904.jpg&MaxH=225&MaxW=225'}\n{u'path': u'A@/href',\n u'text': u'Subscribe',\n u'url': u'/?template=userreglogin&newsletter=true'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Contact Us',\n u'url': u'http://www.ardmoreite.com/contact'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Place an Ad',\n u'url': u'http://ezads.ardmoreite.com'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'E-Ardmoreite',\n u'url': u'http://ardmoredailyardmoreite.ok.ussrv07v.newsmemory.com/index.php'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Manage Account',\n u'url': u'http://ardmoredailyardmoreiteprint.ok.newsmemory.com/code/en/gatehouse/subscription/step1'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Archives',\n u'url': u'http://nl.newsbank.com/nl-search/we/Archives?p_product=DAOB&amp;p_theme=gatehouse&amp;p_action=keyword'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Pro Football Contest',\n u'url': u'http://ardmoreite.profootball.upickem.net/profootball/registration/login.asp'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'College Football Contest',\n u'url': u'http://contests.ardmoreite.com/upickem/registration/login.asp?contestid=99796'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'High School Football Contest',\n u'url': u'http://contests.ardmoreite.com/upickem/registration/login.asp?contestid=144244'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Classifieds',\n u'url': u'http://www.marketplaceadsonline.com/marketplace/OKArd'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u\"Today's Ads\",\n u'url': u'http://ardmoredailyardmoreite.ok.ussrv07v.newsmemory.com/marketplace.php'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'City of Ardmore',\n u'url': u'http://www.ardmorecity.org/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Ardmore Chamber of Commerce',\n u'url': u'http://www.ardmore.org/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Ardmore Convention Center',\n u'url': u'http://www.ardmoreconventioncenter.com/index.php'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Ardmore Tourism',\n u'url': u'http://visitors.ardmore.org/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'News-Star',\n u'url': u'http://www.news-star.com'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Special Sections',\n u'url': u'http://ardmoreite.travidia.com/SS/Tiles.aspx'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Engagement Form',\n u'url': u'http://files.gatehousemedia.com/upload/files/home/ghm_pubs/Ardmoreite_engagement_form-2015.pdf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Wedding Form',\n u'url': u'http://files.gatehousemedia.com/upload/files/home/ghm_pubs/2011_NEW_wedding_form.pdf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Anniversary Form',\n u'url': u'http://files.gatehousemedia.com/upload/files/home/ghm_pubs/NEW_anniversary_announcement.pdf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Birth Form',\n u'url': u'http://files.gatehousemedia.com/upload/files/home/ghm_pubs/birth.pdf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Propel Marketing',\n u'url': u'http://propelmarketing.com/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'GateHouse Media, LLC.',\n u'url': u'http://www.gatehousemedia.com/about-us/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Privacy Policy',\n u'url': u'http://www.gatehousemedia.com/privacy-policy/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Terms Of Service',\n u'url': u'http://www.gatehousemedia.com/terms_of_use/'}\n{u'path': u'A@/href', u'text': u'Close', u'url': u'#'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Home',\n u'url': u'http://www.ardmoreite.com'}\n{u'path': u'A@/href',\n u'text': u'News',\n u'url': u'http://www.ardmoreite.com/news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Community',\n u'url': u'http://www.ardmoreite.com/news/community'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Court News',\n u'url': u'http://www.ardmoreite.com/news/court-news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Education',\n u'url': u'http://www.ardmoreite.com/news/education'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Nation & World',\n u'url': u'http://www.ardmoreite.com/news/nation-world'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Police & Fire',\n u'url': u'http://www.ardmoreite.com/news/police-fire'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'State News',\n u'url': u'http://www.ardmoreite.com/news/state-news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Shareable',\n u'url': u'http://www.ardmoreite.com/news/shareable'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Databases',\n u'url': u'http://www.ardmoreite.com/news/databases'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Election 2016',\n u'url': u'http://www.ardmoreite.com/elections/briefing-2016/todays-topics'}\n{u'path': u'A@/href',\n u'text': u'Sports',\n u'url': u'http://www.ardmoreite.com/sports'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'High School',\n u'url': u'http://www.ardmoreite.com/sports/high-school'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Auto Racing',\n u'url': u'http://www.ardmoreite.com/sports/motor-racing-network'}\n{u'path': u'A@/href',\n u'text': u'Entertainment',\n u'url': u'http://www.ardmoreite.com/entertainment'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Books',\n u'url': u'http://www.ardmoreite.com/entertainment/books'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Celebrity News',\n u'url': u'http://www.ardmoreite.com/entertainment/celebrity-news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Movies',\n u'url': u'http://www.ardmoreite.com/entertainment/movies'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Music',\n u'url': u'http://www.ardmoreite.com/entertainment/music'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'TV Guide',\n u'url': u'http://www.ardmoreite.com/entertainment/tv-guide'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Calendar',\n u'url': u'http://ardmoreite.eviesays.com/'}\n{u'path': u'A@/href',\n u'text': u'Lifestyle',\n u'url': u'http://www.ardmoreite.com/lifestyle'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Boomers',\n u'url': u'http://www.ardmoreite.com/lifestyle/boomers'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Faith',\n u'url': u'http://www.ardmoreite.com/lifestyle/faith'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Family',\n u'url': u'http://www.ardmoreite.com/lifestyle/family'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Food',\n u'url': u'http://www.ardmoreite.com/lifestyle/food'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Health',\n u'url': u'http://www.ardmoreite.com/lifestyle/health'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Home & Garden',\n u'url': u'http://www.ardmoreite.com/lifestyle/home-garden'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Pets',\n u'url': u'http://www.ardmoreite.com/lifestyle/pets'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Travel',\n u'url': u'http://www.ardmoreite.com/lifestyle/travel'}\n{u'path': u'A@/href',\n u'text': u'Opinion',\n u'url': u'http://www.ardmoreite.com/opinion'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Columns',\n u'url': u'http://www.ardmoreite.com/opinion/columns'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Editorials',\n u'url': u'http://www.ardmoreite.com/opinion/editorials'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Letters',\n u'url': u'http://www.ardmoreite.com/opinion/letters'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Business',\n u'url': u'http://www.ardmoreite.com/business-news'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Obituaries',\n u'url': u'http://www.ardmoreite.com/obituaries'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Photos',\n u'url': u'http://www.ardmoreite.com/photos'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Videos',\n u'url': u'http://www.ardmoreite.com/videos'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Calendar',\n u'url': u'http://ardmoreite.eviesays.com/'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Games',\n u'url': u'http://games.ardmoreite.com'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Contests',\n u'url': u'http://www.ardmoreite.com/contests'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Branded Content',\n u'url': u'http://www.ardmoreite.com/ara'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Submit your news',\n u'url': u'http://www.ardmoreite.com/submit'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'E-Edition',\n u'url': u'http://ardmoredailyardmoreite.ok.newsmemory.com/'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Subscribe',\n u'url': u'http://www.ardmoreite.com/subscribenow'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Classifieds',\n u'url': u'http://www.marketplaceadsonline.com/marketplace/OKArd'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Find-N-Save',\n u'url': u'http://findnsave.ardmoreite.com/'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Cars',\n u'url': u'http://www.ardmoreite.com/section/cars'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Jobs',\n u'url': u'http://www.ardmoreite.com/jobs'}\n{u'path': u'A@/href',\n u'target': u'_top',\n u'text': u'Homes',\n u'url': u'http://www.ardmoreite.com/realestate'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Place an Ad',\n u'url': u'http://ezads.ardmoreite.com'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'text': u'Propel Marketing Services',\n u'url': u'http://www.propelmarketing.com/'}\n{u'path': u'A@/href',\n u'text': u'Feedback',\n u'url': u'mailto:yournews@ardmoreite.com'}\n{u'path': u'A@/href',\n u'text': u'Terms of Use',\n u'url': u'http://www.gatehousemedia.com/terms_of_use/'}\n{u'path': u'A@/href',\n u'text': u'Privacy Policy',\n u'url': u'http://www.gatehousemedia.com/privacy-policy/'}\n{u'path': u'A@/href',\n u'text': u'GateHouse Media Publications',\n u'url': u'http://www.gatehousemedia.com/our-markets/'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'title': u'The Daily Ardmoreite Facebook',\n u'url': u'http://www.facebook.com/pages/The-Ardmoreite/143707431292?ref=nf'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'title': u'The Daily Ardmoreite Twitter',\n u'url': u'http://www.twitter.com/Ardmoreite'}\n{u'path': u'A@/href',\n u'target': u'_blank',\n u'title': u'The Daily Ardmoreite RSS Feed',\n u'url': u'/section/feed'}\n{u'path': u'A@/href',\n u'title': u'Contact The Daily Ardmoreite',\n u'url': u'http://www.ardmoreite.com/contact'}\n"}]},"apps":[],"jobName":"paragraph_1503916506945_-120243449","id":"20170826-131553_26290467","dateCreated":"2017-08-28T10:35:06+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4195"},{"text":"%md\n\nFinally, compare the distributions (over json records) of the numbers of <tt>'url'</tt> values seen in a record, for the two nodes just discussed:","user":"anonymous","dateUpdated":"2017-08-28T12:47:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1503924384480_-420686441","id":"20170828-124624_1090708881","dateCreated":"2017-08-28T12:46:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5798","dateFinished":"2017-08-28T12:47:45+0000","dateStarted":"2017-08-28T12:47:45+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Finally, compare the distributions (over json records) of the numbers of <tt>'url'</tt> values seen in a record, for the two nodes just discussed:</p>\n"}]}},{"text":"%pyspark\n\nimport matplotlib.pyplot as plt\n\ndef compare_links(record):\n    try:\n        set1 = set([x['url'] for x in record['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Head']['Link']])\n        set2 = set([x['url'] for x in record['Envelope']['Payload-Metadata']['HTTP-Response-Metadata']['HTML-Metadata']['Links']])\n        return [len(set1), len(set2)]\n    except KeyError:\n        return [0,0]\n\ndef get_link_counts(id_, iterator):\n    for uri in iterator:\n        file = unpack(uri)\n        for record in file:\n            if record['Content-Type'] == 'application/json':\n                record = json.loads(record.payload.read())\n                yield compare_links(record)\n\nlink_counts = files.mapPartitionsWithIndex(get_link_counts)\nlink_count = link_counts.collect()\n\nllinks = [x[0] for x in link_count]\nrlinks = [x[1] for x in link_count]\n\nplt.hist(rlinks, bins=30, alpha=0.4, color='red')\nplt.hist(llinks, bins=30, alpha=0.4, color='green')\nplt.xscale('log')\nplt.yscale('log')\nplt.show()","dateUpdated":"2017-08-28T12:56:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div style='width:auto;height:auto'><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQCAYAAAByNR6YAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAGE9JREFUeJzt3VFonfX9P/CPskj0vyG2LrJ5Dg5vRprQmx0LgS3d1UKCRwxshoBsWZxnmYMy+F24sSvBYb3ZxbxoPVtA5K8lLGXOY8zp9CIKgxVKhRLkVyaukLPdqIxiWxMr5nfx0/DLaNrnid/kSZ68XjDYec55vn46vqtvPt/v831uWl1dXQ0AAJK5uegCAADKRsACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEhMwAIASEzAAgBITMACAEjsS0UXsJvceeed8Y1vfKPoMgBg17lw4UK8//77RZexbQSsDFqtVrRarbjjjjvizJkzRZcDALtOrVYruoRtZYkwg3q9Hs1mM26//faiSwEAdgEBCwAgMQELACAxe7Ay+HwP1sWLF4suBQDYBXSwMrAHCwDIQ8ACAEhMwAIASEzAAgBITMACAEjMU4QZeIoQAMhDBysDTxECAHkIWAAAiVkizOO99yKazaKrAL6oRqPoCoCS08ECAEhMByuH9z69FM0rbyYds3HbYNLxAIDi6WABACQmYAEAJGaJMIPPz8H6aPnjoksBAHYBHawMPj8H69buW4ouBQDYBQQsAIDEBCwAgMQELACAxAQsAIDEBCwAgMQELACAxAQsAIDEBCwAgMT27Enun3zySfzyl7+MS5cuxcDAQPzoRz8quiQAoCRK1cGanJyMnp6e6O/vX3e93W5Hf39/9Pb2xtGjRyMi4uTJk/Gvf/0rurq64mtf+1oR5QIAJVWqgDUxMRHtdnvdtZWVlZiamor5+fk4d+5czM7OxtmzZ+Pvf/97HD58OJ555ploNpsFVQwAlFGpAtbg4GDs27dv3bXTp09HX19fVKvV6Orq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 style='width=auto;height:auto'><div>\n"}]},"apps":[],"jobName":"paragraph_1503916506946_-119089202","id":"20170826-131722_606456893","dateCreated":"2017-08-28T10:35:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4196","user":"anonymous","dateFinished":"2017-08-28T12:56:18+0000","dateStarted":"2017-08-28T12:56:04+0000"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-08-28T12:53:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1503924830783_1687444728","id":"20170828-125350_268264479","dateCreated":"2017-08-28T12:53:50+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5963"}],"name":"201708 common crawl 3 - WAT json structure","id":"2CT9Q8GMU","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}